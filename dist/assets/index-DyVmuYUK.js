var Ks=Object.defineProperty;var Ys=(n,t,s)=>t in n?Ks(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var Bt=(n,t,s)=>Ys(n,typeof t!="symbol"?t+"":t,s);import{r as j,a as Zs,g as Qs,c as M,b as Se}from"./vendor-C1JoJ-56.js";import{u as me,a as Xs,L as er,b as Ze,c as tr,B as sr,R as qt,d as z}from"./router-NdWO1l7T.js";import{L as Gt,M as Q,E as gt,a as _e,b as ft,i as rr,c as we,F as I,C as pt,A as We,U as ae,I as hs,H as ar,B as nr,G as ir,d as or,e as lr,f as cr,T as dr,S as Ne,g as ur,h as ms,j as H,k as D,D as he,X as J,l as xt,m as Qe,n as Xe,o as Me,p as gs,q as hr,P as mr,r as gr,s as Dt,t as fr,u as bt,v as yt,w as $e,x as pr,y as re,z as vt,J as fs,K as Vt,N as Ue,O as Ht,Q as xr,R as br,V as $t,W as ps,Y as Jt,Z as yr,_ as vr,$ as wr,a0 as jr,a1 as _r,a2 as Nr,a3 as kr,a4 as Pt,a5 as Sr,a6 as xs,a7 as Cr,a8 as Ar,a9 as Er}from"./ui-D6tOZrLK.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var bs={exports:{}},et={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Or=j,Tr=Symbol.for("react.element"),Dr=Symbol.for("react.fragment"),$r=Object.prototype.hasOwnProperty,Pr=Or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ir={key:!0,ref:!0,__self:!0,__source:!0};function ys(n,t,s){var r,a={},i=null,o=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)$r.call(t,r)&&!Ir.hasOwnProperty(r)&&(a[r]=t[r]);if(n&&n.defaultProps)for(r in t=n.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Tr,type:n,key:i,ref:o,props:a,_owner:Pr.current}}et.Fragment=Dr;et.jsx=ys;et.jsxs=ys;bs.exports=et;var e=bs.exports,wt={},Wt=Zs;wt.createRoot=Wt.createRoot,wt.hydrateRoot=Wt.hydrateRoot;const Rr="modulepreload",Ur=function(n){return"/adminizer-demo/"+n},Kt={},Fe=function(t,s,r){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=Ur(c),c in Kt)return;Kt[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Rr,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,g)=>{h.addEventListener("load",m),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Lr=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...s)=>Fe(async()=>{const{default:r}=await Promise.resolve().then(()=>Ce);return{default:r}},void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)};class It extends Error{constructor(t,s="FunctionsError",r){super(t),this.name=s,this.context=r}}class Mr extends It{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Fr extends It{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class zr extends It{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(jt||(jt={}));var Br=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};class qr{constructor(t,{headers:s={},customFetch:r,region:a=jt.Any}={}){this.url=t,this.headers=s,this.region=a,this.fetch=Lr(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,s={}){var r;return Br(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=s;let l={},{region:c}=s;c||(c=this.region),c&&c!=="any"&&(l["x-region"]=c);let d;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:d}).catch(v=>{throw new Mr(v)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new Fr(u);if(!u.ok)throw new zr(u);let m=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield u.json():m==="application/octet-stream"?g=yield u.blob():m==="text/event-stream"?g=u:m==="multipart/form-data"?g=yield u.formData():g=yield u.text(),{data:g,error:null}}catch(a){return{data:null,error:a}}})}}var L={},Rt={},tt={},ze={},st={},rt={},Gr=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ke=Gr();const Vr=ke.fetch,vs=ke.fetch.bind(ke),ws=ke.Headers,Hr=ke.Request,Jr=ke.Response,Ce=Object.freeze(Object.defineProperty({__proto__:null,Headers:ws,Request:Hr,Response:Jr,default:vs,fetch:Vr},Symbol.toStringTag,{value:"Module"})),Wr=Qs(Ce);var at={};Object.defineProperty(at,"__esModule",{value:!0});let Kr=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};at.default=Kr;var js=M&&M.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rt,"__esModule",{value:!0});const Yr=js(Wr),Zr=js(at);let Qr=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Yr.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=Object.assign({},this.headers),this.headers[t]=s,this}then(t,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let d=null,u=null,h=null,m=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const p=await i.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=p:u=JSON.parse(p))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const b=await i.text();try{d=JSON.parse(b),Array.isArray(d)&&i.status===404&&(u=[],d=null,m=200,g="OK")}catch{i.status===404&&b===""?(m=204,g="No Content"):d={message:b}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,m=200,g="OK"),d&&this.shouldThrowOnError)throw new Zr.default(d)}return{error:d,data:u,count:h,status:m,statusText:g}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,s)}returns(){return this}overrideTypes(){return this}};rt.default=Qr;var Xr=M&&M.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(st,"__esModule",{value:!0});const ea=Xr(rt);let ta=class extends ea.default{select(t){let s=!1;const r=(t??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:s=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${s?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:s,referencedTable:r=s}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,s,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${s-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:s=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,s?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};st.default=ta;var sa=M&&M.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ze,"__esModule",{value:!0});const ra=sa(st);let aa=class extends ra.default{eq(t,s){return this.url.searchParams.append(t,`eq.${s}`),this}neq(t,s){return this.url.searchParams.append(t,`neq.${s}`),this}gt(t,s){return this.url.searchParams.append(t,`gt.${s}`),this}gte(t,s){return this.url.searchParams.append(t,`gte.${s}`),this}lt(t,s){return this.url.searchParams.append(t,`lt.${s}`),this}lte(t,s){return this.url.searchParams.append(t,`lte.${s}`),this}like(t,s){return this.url.searchParams.append(t,`like.${s}`),this}likeAllOf(t,s){return this.url.searchParams.append(t,`like(all).{${s.join(",")}}`),this}likeAnyOf(t,s){return this.url.searchParams.append(t,`like(any).{${s.join(",")}}`),this}ilike(t,s){return this.url.searchParams.append(t,`ilike.${s}`),this}ilikeAllOf(t,s){return this.url.searchParams.append(t,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(t,s){return this.url.searchParams.append(t,`ilike(any).{${s.join(",")}}`),this}is(t,s){return this.url.searchParams.append(t,`is.${s}`),this}in(t,s){const r=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cs.{${s.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(s)}`),this}containedBy(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cd.{${s.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(s)}`),this}rangeGt(t,s){return this.url.searchParams.append(t,`sr.${s}`),this}rangeGte(t,s){return this.url.searchParams.append(t,`nxl.${s}`),this}rangeLt(t,s){return this.url.searchParams.append(t,`sl.${s}`),this}rangeLte(t,s){return this.url.searchParams.append(t,`nxr.${s}`),this}rangeAdjacent(t,s){return this.url.searchParams.append(t,`adj.${s}`),this}overlaps(t,s){return typeof s=="string"?this.url.searchParams.append(t,`ov.${s}`):this.url.searchParams.append(t,`ov.{${s.join(",")}}`),this}textSearch(t,s,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${o}.${s}`),this}match(t){return Object.entries(t).forEach(([s,r])=>{this.url.searchParams.append(s,`eq.${r}`)}),this}not(t,s,r){return this.url.searchParams.append(t,`not.${s}.${r}`),this}or(t,{foreignTable:s,referencedTable:r=s}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,s,r){return this.url.searchParams.append(t,`${s}.${r}`),this}};ze.default=aa;var na=M&&M.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(tt,"__esModule",{value:!0});const Te=na(ze);let ia=class{constructor(t,{headers:s={},schema:r,fetch:a}){this.url=t,this.headers=s,this.schema=r,this.fetch=a}select(t,{head:s=!1,count:r}={}){const a=s?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Te.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:s,defaultToNull:r=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),s&&i.push(`count=${s}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Te.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:s,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Te.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:s}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),this.headers.Prefer=a.join(","),new Te.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const s="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Te.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};tt.default=ia;var nt={},it={};Object.defineProperty(it,"__esModule",{value:!0});it.version=void 0;it.version="0.0.0-automated";Object.defineProperty(nt,"__esModule",{value:!0});nt.DEFAULT_HEADERS=void 0;const oa=it;nt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${oa.version}`};var _s=M&&M.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Rt,"__esModule",{value:!0});const la=_s(tt),ca=_s(ze),da=nt;let ua=class Ns{constructor(t,{headers:s={},schema:r,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},da.DEFAULT_HEADERS),s),this.schemaName=r,this.fetch=a}from(t){const s=new URL(`${this.url}/${t}`);return new la.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ns(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:r=!1,get:a=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;r||a?(o=r?"HEAD":"GET",Object.entries(s).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=s);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new ca.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Rt.default=ua;var Ae=M&&M.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(L,"__esModule",{value:!0});L.PostgrestError=L.PostgrestBuilder=L.PostgrestTransformBuilder=L.PostgrestFilterBuilder=L.PostgrestQueryBuilder=L.PostgrestClient=void 0;const ks=Ae(Rt);L.PostgrestClient=ks.default;const Ss=Ae(tt);L.PostgrestQueryBuilder=Ss.default;const Cs=Ae(ze);L.PostgrestFilterBuilder=Cs.default;const As=Ae(st);L.PostgrestTransformBuilder=As.default;const Es=Ae(rt);L.PostgrestBuilder=Es.default;const Os=Ae(at);L.PostgrestError=Os.default;var ha=L.default={PostgrestClient:ks.default,PostgrestQueryBuilder:Ss.default,PostgrestFilterBuilder:Cs.default,PostgrestTransformBuilder:As.default,PostgrestBuilder:Es.default,PostgrestError:Os.default};const{PostgrestClient:ma,PostgrestQueryBuilder:Vi,PostgrestFilterBuilder:Hi,PostgrestTransformBuilder:Ji,PostgrestBuilder:Wi,PostgrestError:Ki}=ha;let _t;typeof window>"u"?_t=require("ws"):_t=window.WebSocket;const ga="2.11.10",fa={"X-Client-Info":`realtime-js/${ga}`},pa="1.0.0",Ts=1e4,xa=1e3;var je;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(je||(je={}));var R;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(R||(R={}));var q;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(q||(q={}));var Nt;(function(n){n.websocket="websocket"})(Nt||(Nt={}));var de;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(de||(de={}));class ba{constructor(){this.HEADER_LENGTH=1}decode(t,s){return t.constructor===ArrayBuffer?s(this._binaryDecode(t)):s(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const s=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,s,r)}_decodeBroadcast(t,s,r){const a=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+a));o=o+a;const c=r.decode(t.slice(o,o+i));o=o+i;const d=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Ds{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var E;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(E||(E={}));const Yt=(n,t,s={})=>{var r;const a=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((i,o)=>(i[o]=ya(o,n,t,a),i),{})},ya=(n,t,s,r)=>{const a=t.find(l=>l.name===n),i=a==null?void 0:a.type,o=s[n];return i&&!r.includes(i)?$s(i,o):kt(o)},$s=(n,t)=>{if(n.charAt(0)==="_"){const s=n.slice(1,n.length);return _a(t,s)}switch(n){case E.bool:return va(t);case E.float4:case E.float8:case E.int2:case E.int4:case E.int8:case E.numeric:case E.oid:return wa(t);case E.json:case E.jsonb:return ja(t);case E.timestamp:return Na(t);case E.abstime:case E.date:case E.daterange:case E.int4range:case E.int8range:case E.money:case E.reltime:case E.text:case E.time:case E.timestamptz:case E.timetz:case E.tsrange:case E.tstzrange:return kt(t);default:return kt(t)}},kt=n=>n,va=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},wa=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},ja=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},_a=(n,t)=>{if(typeof n!="string")return n;const s=n.length-1,r=n[s];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>$s(t,l))}return n},Na=n=>typeof n=="string"?n.replace(" ","T"):n,Ps=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class lt{constructor(t,s,r={},a=Ts){this.channel=t,this.event=s,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var r;return this._hasReceived(t)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Zt;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Zt||(Zt={}));class Pe{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pe.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=Pe.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Pe.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,r,a){const i=this.cloneDeep(t),o=this.transformState(s),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=i[d];if(h){const m=u.map(x=>x.presence_ref),g=h.map(x=>x.presence_ref),v=u.filter(x=>g.indexOf(x.presence_ref)<0),b=h.filter(x=>m.indexOf(x.presence_ref)<0);v.length>0&&(l[d]=v),b.length>0&&(c[d]=b)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},r,a)}static syncDiff(t,s,r,a){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const h=t[l].map(g=>g.presence_ref),m=u.filter(g=>h.indexOf(g.presence_ref)<0);t[l].unshift(...m)}r(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(r=>s(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,r)=>{const a=t[r];return"metas"in a?s[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=a,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qt;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Qt||(Qt={}));var Xt;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Xt||(Xt={}));var Z;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Z||(Z={}));class Ut{constructor(t,s={config:{}},r){this.topic=t,this.params=s,this.socket=r,this.bindings={},this.state=R.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new lt(this,q.join,this.params,this.timeout),this.rejoinTimer=new Ds(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=R.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=R.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this._on(q.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Pe(this),this.broadcastEndpointURL=Ps(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,s=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(u=>t==null?void 0:t(Z.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Z.CLOSED));const c={},d={broadcast:i,presence:o,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&a!==void 0?a:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){t==null||t(Z.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(h=m==null?void 0:m.length)!==null&&h!==void 0?h:0,v=[];for(let b=0;b<g;b++){const x=m[b],{filter:{event:p,schema:w,table:f,filter:y}}=x,k=u&&u[b];if(k&&k.event===p&&k.schema===w&&k.table===f&&k.filter===y)v.push(Object.assign(Object.assign({},x),{id:k.id}));else{this.unsubscribe(),this.state=R.errored,t==null||t(Z.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Z.SUBSCRIBED);return}}).receive("error",u=>{this.state=R.errored,t==null||t(Z.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Z.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,r){return this._on(t,s,r)}async send(t,s={}){var r,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=R.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(q.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(r=>{const a=new lt(this,q.leave,{},t);a.receive("ok",()=>{s(),r("ok")}).receive("timeout",()=>{s(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,s,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:a.signal}));return clearTimeout(i),o}_push(t,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new lt(this,t,s,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,s,r){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,r){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=q;if(r&&[l,c,d,u].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,s,r);if(s&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(g=>{var v,b,x;return((v=g.filter)===null||v===void 0?void 0:v.event)==="*"||((x=(b=g.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(g=>g.callback(m,r)):(i=this.bindings[o])===null||i===void 0||i.filter(g=>{var v,b,x,p,w,f;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const y=g.id,k=(v=g.filter)===null||v===void 0?void 0:v.event;return y&&((b=s.ids)===null||b===void 0?void 0:b.includes(y))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((x=s.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const y=(w=(p=g==null?void 0:g.filter)===null||p===void 0?void 0:p.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return y==="*"||y===((f=s==null?void 0:s.event)===null||f===void 0?void 0:f.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof m=="object"&&"ids"in m){const v=m.data,{schema:b,table:x,commit_timestamp:p,type:w,errors:f}=v;m=Object.assign(Object.assign({},{schema:b,table:x,commit_timestamp:p,eventType:w,new:{},old:{},errors:f}),this._getPayloadRecords(v))}g.callback(m,r)})}_isClosed(){return this.state===R.closed}_isJoined(){return this.state===R.joined}_isJoining(){return this.state===R.joining}_isLeaving(){return this.state===R.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,r){const a=t.toLocaleLowerCase(),i={type:a,filter:s,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,s){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Ut.isEqual(a.filter,s))}),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const r in t)if(t[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(q.close,{},t)}_onError(t){this._on(q.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=R.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=Yt(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=Yt(t.columns,t.old_record)),s}}const es=()=>{},ka=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Sa{constructor(t,s){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=fa,this.params={},this.timeout=Ts,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=es,this.ref=0,this.logger=es,this.conn=null,this.sendBuffer=[],this.serializer=new ba,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Fe(async()=>{const{default:c}=await Promise.resolve().then(()=>Ce);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${Nt.websocket}`,this.httpEndpoint=Ps(t),s!=null&&s.transport?this.transport=s.transport:this.transport=null,s!=null&&s.params&&(this.params=s.params),s!=null&&s.headers&&(this.headers=Object.assign(Object.assign({},this.headers),s.headers)),s!=null&&s.timeout&&(this.timeout=s.timeout),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),s!=null&&s.heartbeatIntervalMs&&(this.heartbeatIntervalMs=s.heartbeatIntervalMs);const a=(r=s==null?void 0:s.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=s!=null&&s.reconnectAfterMs?s.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=s!=null&&s.encode?s.encode:(i,o)=>o(JSON.stringify(i)),this.decode=s!=null&&s.decode?s.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ds(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(s==null?void 0:s.fetch),s!=null&&s.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(s==null?void 0:s.worker)||!1,this.workerUrl=s==null?void 0:s.workerUrl}this.accessToken=(s==null?void 0:s.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=_t),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Ca(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:pa}))}disconnect(t,s){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,s??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels=this.channels.filter(r=>r._joinRef!==t._joinRef),this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,s,r){this.logger(t,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case je.connecting:return de.Connecting;case je.open:return de.Open;case je.closing:return de.Closing;default:return de.Closed}}isConnected(){return this.connectionState()===de.Open}channel(t,s={config:{}}){const r=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new Ut(`realtime:${t}`,s,this);return this.channels.push(i),i}}push(t){const{topic:s,event:r,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${s} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let s=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(r=>{s&&r.updateJoinPayload({access_token:s,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(q.access_token,{access_token:s})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(xa,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,s=>{let{topic:r,event:a,payload:i,ref:o}=s;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(s.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(s))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(s=>s(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(s=>s(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(q.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const r=t.match(/\?/)?"&":"?",a=new URLSearchParams(s);return`${t}${r}${a}`}_workerObjectUrl(t){let s;if(t)s=t;else{const r=new Blob([ka],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}}class Ca{constructor(t,s,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=je.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}}class Lt extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function T(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Aa extends Lt{constructor(t,s){super(t),this.name="StorageApiError",this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class St extends Lt{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}var Ea=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};const Is=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...s)=>Fe(async()=>{const{default:r}=await Promise.resolve().then(()=>Ce);return{default:r}},void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},Oa=()=>Ea(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Fe(()=>Promise.resolve().then(()=>Ce),void 0)).Response:Response}),Ct=n=>{if(Array.isArray(n))return n.map(s=>Ct(s));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([s,r])=>{const a=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Ct(r)}),t};var ge=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};const ct=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ta=(n,t,s)=>ge(void 0,void 0,void 0,function*(){const r=yield Oa();n instanceof r&&!(s!=null&&s.noResolveJson)?n.json().then(a=>{t(new Aa(ct(a),n.status||500))}).catch(a=>{t(new St(ct(a),a))}):t(new St(ct(n),n))}),Da=(n,t,s,r)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),s))};function Be(n,t,s,r,a,i){return ge(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(s,Da(t,r,a,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Ta(c,l,r))})})}function Ke(n,t,s,r){return ge(this,void 0,void 0,function*(){return Be(n,"GET",t,s,r)})}function te(n,t,s,r,a){return ge(this,void 0,void 0,function*(){return Be(n,"POST",t,r,a,s)})}function $a(n,t,s,r,a){return ge(this,void 0,void 0,function*(){return Be(n,"PUT",t,r,a,s)})}function Pa(n,t,s,r){return ge(this,void 0,void 0,function*(){return Be(n,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function Rs(n,t,s,r,a){return ge(this,void 0,void 0,function*(){return Be(n,"DELETE",t,r,a,s)})}var U=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};const Ia={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ts={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ra{constructor(t,s={},r,a){this.url=t,this.headers=s,this.bucketId=r,this.fetch=Is(a)}uploadOrUpdate(t,s,r,a){return U(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},ts),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(s),u=this._getFinalPath(d),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),m=yield h.json();return h.ok?{data:{path:d,id:m.Id,fullPath:m.Key},error:null}:{data:null,error:m}}catch(i){if(T(i))return{data:null,error:i};throw i}})}upload(t,s,r){return U(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,r)})}uploadToSignedUrl(t,s,r,a){return U(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",s);try{let c;const d=Object.assign({upsert:ts.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:u}),m=yield h.json();return h.ok?{data:{path:i,fullPath:m.Key},error:null}:{data:null,error:m}}catch(c){if(T(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,s){return U(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const a=Object.assign({},this.headers);s!=null&&s.upsert&&(a["x-upsert"]="true");const i=yield te(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Lt("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(T(r))return{data:null,error:r};throw r}})}update(t,s,r){return U(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,r)})}move(t,s,r){return U(this,void 0,void 0,function*(){try{return{data:yield te(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(T(a))return{data:null,error:a};throw a}})}copy(t,s,r){return U(this,void 0,void 0,function*(){try{return{data:{path:(yield te(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(T(a))return{data:null,error:a};throw a}})}createSignedUrl(t,s,r){return U(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield te(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:s},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(T(a))return{data:null,error:a};throw a}})}createSignedUrls(t,s,r){return U(this,void 0,void 0,function*(){try{const a=yield te(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(T(a))return{data:null,error:a};throw a}})}download(t,s){return U(this,void 0,void 0,function*(){const a=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Ke(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(T(l))return{data:null,error:l};throw l}})}info(t){return U(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const r=yield Ke(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Ct(r),error:null}}catch(r){if(T(r))return{data:null,error:r};throw r}})}exists(t){return U(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield Pa(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(T(r)&&r instanceof St){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,s){const r=this._getFinalPath(t),a=[],i=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&a.push(i);const l=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(t){return U(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}list(t,s,r){return U(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Ia),s),{prefix:t||""});return{data:yield te(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(T(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const Ua="2.7.1",La={"X-Client-Info":`storage-js/${Ua}`};var fe=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};class Ma{constructor(t,s={},r){this.url=t,this.headers=Object.assign(Object.assign({},La),s),this.fetch=Is(r)}listBuckets(){return fe(this,void 0,void 0,function*(){try{return{data:yield Ke(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(T(t))return{data:null,error:t};throw t}})}getBucket(t){return fe(this,void 0,void 0,function*(){try{return{data:yield Ke(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}createBucket(t,s={public:!1}){return fe(this,void 0,void 0,function*(){try{return{data:yield te(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(T(r))return{data:null,error:r};throw r}})}updateBucket(t,s){return fe(this,void 0,void 0,function*(){try{return{data:yield $a(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(T(r))return{data:null,error:r};throw r}})}emptyBucket(t){return fe(this,void 0,void 0,function*(){try{return{data:yield te(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}deleteBucket(t){return fe(this,void 0,void 0,function*(){try{return{data:yield Rs(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(T(s))return{data:null,error:s};throw s}})}}class Fa extends Ma{constructor(t,s={},r){super(t,s,r)}from(t){return new Ra(this.url,this.headers,t,this.fetch)}}const za="2.50.0";let De="";typeof Deno<"u"?De="deno":typeof document<"u"?De="web":typeof navigator<"u"&&navigator.product==="ReactNative"?De="react-native":De="node";const Ba={"X-Client-Info":`supabase-js-${De}/${za}`},qa={headers:Ba},Ga={schema:"public"},Va={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ha={};var Ja=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};const Wa=n=>{let t;return n?t=n:typeof fetch>"u"?t=vs:t=fetch,(...s)=>t(...s)},Ka=()=>typeof Headers>"u"?ws:Headers,Ya=(n,t,s)=>{const r=Wa(s),a=Ka();return(i,o)=>Ja(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:n;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:d}))})};var Za=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};function Qa(n){return n.endsWith("/")?n:n+"/"}function Xa(n,t){var s,r;const{db:a,auth:i,realtime:o,global:l}=n,{db:c,auth:d,realtime:u,global:h}=t,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(s=h==null?void 0:h.headers)!==null&&s!==void 0?s:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Za(this,void 0,void 0,function*(){return""})};return n.accessToken?m.accessToken=n.accessToken:delete m.accessToken,m}const Us="2.70.0",ye=30*1e3,At=3,dt=At*ye,en="http://localhost:9999",tn="supabase.auth.token",sn={"X-Client-Info":`gotrue-js/${Us}`},Et="X-Supabase-Api-Version",Ls={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rn=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,an=6e5;class Mt extends Error{constructor(t,s,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function S(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class nn extends Mt{constructor(t,s,r){super(t,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function on(n){return S(n)&&n.name==="AuthApiError"}class Ms extends Mt{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class ne extends Mt{constructor(t,s,r,a){super(t,r,a),this.name=s,this.status=r}}class ee extends ne{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ln(n){return S(n)&&n.name==="AuthSessionMissingError"}class qe extends ne{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ge extends ne{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ve extends ne{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function cn(n){return S(n)&&n.name==="AuthImplicitGrantRedirectError"}class ss extends ne{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ot extends ne{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function ut(n){return S(n)&&n.name==="AuthRetryableFetchError"}class rs extends ne{constructor(t,s,r){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class Ie extends ne{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ye="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),as=` 	
\r=`.split(""),dn=(()=>{const n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<as.length;t+=1)n[as[t].charCodeAt(0)]=-2;for(let t=0;t<Ye.length;t+=1)n[Ye[t].charCodeAt(0)]=t;return n})();function ns(n,t,s){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;s(Ye[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;s(Ye[r]),t.queuedBits-=6}}function Fs(n,t,s){const r=dn[n];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function is(n){const t=[],s=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{mn(o,r,s)};for(let o=0;o<n.length;o+=1)Fs(n.charCodeAt(o),a,i);return t.join("")}function un(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function hn(n,t){for(let s=0;s<n.length;s+=1){let r=n.charCodeAt(s);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(n.charCodeAt(s+1)-56320&65535|a)+65536,s+=1}un(r,t)}}function mn(n,t,s){if(t.utf8seq===0){if(n<=127){s(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&s(t.codepoint)}}function gn(n){const t=[],s={queue:0,queuedBits:0},r=a=>{t.push(a)};for(let a=0;a<n.length;a+=1)Fs(n.charCodeAt(a),s,r);return new Uint8Array(t)}function fn(n){const t=[];return hn(n,s=>t.push(s)),new Uint8Array(t)}function pn(n){const t=[],s={queue:0,queuedBits:0},r=a=>{t.push(a)};return n.forEach(a=>ns(a,s,r)),ns(null,s,r),t.join("")}function xn(n){return Math.round(Date.now()/1e3)+n}function bn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}const B=()=>typeof window<"u"&&typeof document<"u",le={tested:!1,writable:!1},Re=()=>{if(!B())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(le.tested)return le.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),le.tested=!0,le.writable=!0}catch{le.tested=!0,le.writable=!1}return le.writable};function yn(n){const t={},s=new URL(n);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return s.searchParams.forEach((r,a)=>{t[a]=r}),t}const zs=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...s)=>Fe(async()=>{const{default:r}=await Promise.resolve().then(()=>Ce);return{default:r}},void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},vn=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Bs=async(n,t,s)=>{await n.setItem(t,JSON.stringify(s))},He=async(n,t)=>{const s=await n.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Je=async(n,t)=>{await n.removeItem(t)};class ot{constructor(){this.promise=new ot.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}ot.promiseConstructor=Promise;function ht(n){const t=n.split(".");if(t.length!==3)throw new Ie("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!rn.test(t[r]))throw new Ie("JWT not in base64url format");return{header:JSON.parse(is(t[0])),payload:JSON.parse(is(t[1])),signature:gn(t[2]),raw:{header:t[0],payload:t[1]}}}async function wn(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function jn(n,t){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!t(i,null,o)){r(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function _n(n){return("0"+n.toString(16)).substr(-2)}function Nn(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let a="";for(let i=0;i<56;i++)a+=s.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(t),Array.from(t,_n).join("")}async function kn(n){const s=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",s),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Sn(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const s=await kn(n);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pe(n,t,s=!1){const r=Nn();let a=r;s&&(a+="/PASSWORD_RECOVERY"),await Bs(n,`${t}-code-verifier`,a);const i=await Sn(r);return[i,r===i?"plain":"s256"]}const Cn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function An(n){const t=n.headers.get(Et);if(!t||!t.match(Cn))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function En(n){if(!n)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function On(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Tn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xe(n){if(!Tn.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Dn=function(n,t){var s={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(s[r[a]]=n[r[a]]);return s};const ce=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),$n=[502,503,504];async function os(n){var t;if(!vn(n))throw new Ot(ce(n),0);if($n.includes(n.status))throw new Ot(ce(n),n.status);let s;try{s=await n.json()}catch(i){throw new Ms(ce(i),i)}let r;const a=An(n);if(a&&a.getTime()>=Ls["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new rs(ce(s),n.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new ee}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new rs(ce(s),n.status,s.weak_password.reasons);throw new nn(ce(s),n.status||500,r)}const Pn=(n,t,s,r)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),s))};async function C(n,t,s,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Et]||(i[Et]=Ls["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await In(n,t,s+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function In(n,t,s,r,a,i){const o=Pn(t,r,a,i);let l;try{l=await n(s,Object.assign({},o))}catch(c){throw console.error(c),new Ot(ce(c),0)}if(l.ok||await os(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await os(c)}}function Y(n){var t;let s=null;Mn(n)&&(s=Object.assign({},n),n.expires_at||(s.expires_at=xn(n.expires_in)));const r=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:s,user:r},error:null}}function ls(n){const t=Y(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(t.data.weak_password=n.weak_password),t}function se(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function Rn(n){return{data:n,error:null}}function Un(n){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:i}=n,o=Dn(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Ln(n){return n}function Mn(n){return n.access_token&&n.refresh_token&&n.expires_in}const mt=["global","local","others"];var Fn=function(n,t){var s={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(s[r[a]]=n[r[a]]);return s};class zn{constructor({url:t="",headers:s={},fetch:r}){this.url=t,this.headers=s,this.fetch=zs(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,s=mt[0]){if(mt.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mt.join(", ")}`);try{return await C(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,s={}){try{return await C(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:se})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:s}=t,r=Fn(t,["options"]),a=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await C(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Un,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(S(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await C(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:se})}catch(s){if(S(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,r,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await C(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Ln});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(v.split(";")[1].split("=")[1]);d[`${x}Page`]=b}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(S(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){xe(t);try{return await C(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:se})}catch(s){if(S(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){xe(t);try{return await C(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:se})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,s=!1){xe(t);try{return await C(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:se})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){xe(t.userId);try{const{data:s,error:r}=await C(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:s,error:r}}catch(s){if(S(s))return{data:null,error:s};throw s}}async _deleteFactor(t){xe(t.userId),xe(t.id);try{return{data:await C(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(S(s))return{data:null,error:s};throw s}}}const Bn={getItem:n=>Re()?globalThis.localStorage.getItem(n):null,setItem:(n,t)=>{Re()&&globalThis.localStorage.setItem(n,t)},removeItem:n=>{Re()&&globalThis.localStorage.removeItem(n)}};function cs(n={}){return{getItem:t=>n[t]||null,setItem:(t,s)=>{n[t]=s},removeItem:t=>{delete n[t]}}}function qn(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const be={debug:!!(globalThis&&Re()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qs extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Gn extends qs{}async function Vn(n,t,s){be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),be.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await s()}finally{be.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(t===0)throw be.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Gn(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(be.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}qn();const Hn={url:en,storageKey:tn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sn,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ds(n,t,s){return await s()}class Le{constructor(t){var s,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Le.nextInstanceID,Le.nextInstanceID+=1,this.instanceID>0&&B()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Hn),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new zn({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=zs(a.fetch),this.lock=a.lock||ds,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:B()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Vn:this.lock=ds,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Re()?this.storage=Bn:(this.memoryStorage={},this.storage=cs(this.memoryStorage)):(this.memoryStorage={},this.storage=cs(this.memoryStorage)),B()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Us}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const s=yn(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce"),B()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),cn(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return S(s)?{error:s}:{error:new Ms("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,r,a;try{const i=await C(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Y}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var s,r,a;try{let i;if("email"in t){const{email:u,password:h,options:m}=t;let g=null,v=null;this.flowType==="pkce"&&([g,v]=await pe(this.storage,this.storageKey)),i=await C(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:g,code_challenge_method:v},xform:Y})}else if("phone"in t){const{phone:u,password:h,options:m}=t;i=await C(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(a=m==null?void 0:m.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Y})}else throw new Ge("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let s;if("email"in t){const{email:i,password:o,options:l}=t;s=await C(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ls})}else if("phone"in t){const{phone:i,password:o,options:l}=t;s=await C(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ls})}else throw new Ge("You must provide either an email or phone number and a password");const{data:r,error:a}=s;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new qe}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(t){var s,r,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:s}=t;if(s==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(t){var s,r,a,i,o,l,c,d,u,h,m,g;let v,b;if("message"in t)v=t.message,b=t.signature;else{const{chain:x,wallet:p,statement:w,options:f}=t;let y;if(B())if(typeof p=="object")y=p;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))y=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(f!=null&&f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=p}const k=new URL((s=f==null?void 0:f.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in y&&y.signIn){const A=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},f==null?void 0:f.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let O;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")O=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)O=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)v=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),b=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in y)||typeof y.signMessage!="function"||!("publicKey"in y)||typeof y!="object"||!y.publicKey||!("toBase58"in y.publicKey)||typeof y.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${k.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(a=(r=f==null?void 0:f.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=f==null?void 0:f.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${f.signInWithSolana.notBefore}`]:[],...!((o=f==null?void 0:f.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${f.signInWithSolana.expirationTime}`]:[],...!((l=f==null?void 0:f.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${f.signInWithSolana.chainId}`]:[],...!((c=f==null?void 0:f.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${f.signInWithSolana.nonce}`]:[],...!((d=f==null?void 0:f.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${f.signInWithSolana.requestId}`]:[],...!((h=(u=f==null?void 0:f.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...f.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const A=await y.signMessage(new TextEncoder().encode(v),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=A}}try{const{data:x,error:p}=await C(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:pn(b)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Y});if(p)throw p;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new qe}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:p})}catch(x){if(S(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const s=await He(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(s??"").split("/");try{const{data:i,error:o}=await C(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Y});if(await Je(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new qe}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(S(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:s,provider:r,token:a,access_token:i,nonce:o}=t,l=await C(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Y}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new qe}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(t){var s,r,a,i,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await pe(this.storage,this.storageKey));const{error:h}=await C(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await C(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Ge("You must provide either an email or phone number.")}catch(l){if(S(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var s,r;try{let a,i;"options"in t&&(a=(s=t.options)===null||s===void 0?void 0:s.redirectTo,i=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await C(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Y});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(S(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var s,r,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await pe(this.storage,this.storageKey)),await C(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Rn})}catch(i){if(S(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:r}=t;if(r)throw r;if(!s)throw new ee;const{error:a}=await C(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:r,type:a,options:i}=t,{error:o}=await C(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:a,options:i}=t,{data:o,error:l}=await C(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Ge("You must provide either an email or phone number and a type")}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await He(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<dt:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await C(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:se}):await this._useSession(async s=>{var r,a,i;const{data:o,error:l}=s;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ee}:await C(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:se})})}catch(s){if(S(s))return ln(s)&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new ee;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await pe(this.storage,this.storageKey));const{data:d,error:u}=await C(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:se});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(S(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ee;const s=Date.now()/1e3;let r=s,a=!0,i=null;const{payload:o}=ht(t.access_token);if(o.exp&&(r=o.exp,a=r<=s),a){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(S(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var r;if(!t){const{data:o,error:l}=s;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new ee;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(S(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(t,s){try{if(!B())throw new Ve("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ve(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new ss("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ve("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ss("No code detected.");const{data:w,error:f}=await this._exchangeCodeForSession(t.code);if(f)throw f;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!o||!d)throw new Ve("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const g=m-u;g*1e3<=ye&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const v=m-h;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,m,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,m,u);const{data:b,error:x}=await this._getUser(i);if(x)throw x;const p={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:t.type},error:null}}catch(r){if(S(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await He(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:a,error:i}=s;if(i)return{error:i};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(on(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const s=bn(),r={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async s=>{var r,a;try{const{data:{session:i},error:o}=s;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,s={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await pe(this.storage,this.storageKey,!0));try{return await C(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(S(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(s){if(S(s))return{data:null,error:s};throw s}}async linkIdentity(t){var s;try{const{data:r,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:h,error:m}=i;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await C(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return B()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(S(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async s=>{var r,a;const{data:i,error:o}=s;if(o)throw o;return await C(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(s){if(S(s))return{data:null,error:s};throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await jn(async a=>(a>0&&await wn(200*Math.pow(2,a-1)),this._debug(s,"refreshing attempt",a),await C(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Y})),(a,i)=>{const o=200*Math.pow(2,a);return i&&ut(i)&&Date.now()+o-r<ye})}catch(r){if(this._debug(s,"error",r),S(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",r),B()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await He(this.storage,this.storageKey);if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const a=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<dt;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${dt}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),ut(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var s,r;if(!t)throw new ee;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ot;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new ee;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),S(i)){const o={session:null,error:i};return ut(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,s,r=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,s)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Bs(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Je(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&B()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ye);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-t)/ye);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ye}ms, refresh threshold is ${At} ticks`),a<=At&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof qs)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!B()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,r){const a=[`provider=${encodeURIComponent(s)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await pe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var r;const{data:a,error:i}=s;return i?{data:null,error:i}:await C(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(S(s))return{data:null,error:s};throw s}}async _enroll(t){try{return await this._useSession(async s=>{var r,a;const{data:i,error:o}=s;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=await C(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(s){if(S(s))return{data:null,error:s};throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:a,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:l}=await C(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(s){if(S(s))return{data:null,error:s};throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:a,error:i}=s;return i?{data:null,error:i}:await C(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(S(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(t){const{data:s,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const r=(t==null?void 0:t.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var s,r;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ht(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(s=a.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,s={keys:[]}){let r=s.keys.find(o=>o.kid===t);if(r||(r=this.jwks.keys.find(o=>o.kid===t),r&&this.jwks_cached_at+an>Date.now()))return r;const{data:a,error:i}=await C(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new Ie("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(o=>o.kid===t),!r)throw new Ie("No matching signing key found in JWKS");return r}async getClaims(t,s={keys:[]}){try{let r=t;if(!r){const{data:g,error:v}=await this.getSession();if(v||!g.session)return{data:null,error:v};r=g.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=ht(r);if(En(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:i,header:a,signature:o},error:null}}const d=On(a.alg),u=await this.fetchJwk(a.kid,s),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,fn(`${l}.${c}`)))throw new Ie("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(S(r))return{data:null,error:r};throw r}}}Le.nextInstanceID=0;const Jn=Le;class Wn extends Jn{constructor(t){super(t)}}var Kn=function(n,t,s,r){function a(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((r=r.apply(n,t||[])).next())})};class Yn{constructor(t,s,r){var a,i,o;if(this.supabaseUrl=t,this.supabaseKey=s,!t)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const l=Qa(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:Ga,realtime:Ha,auth:Object.assign(Object.assign({},Va),{storageKey:d}),global:qa},h=Xa(r??{},u);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=Ya(s,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new ma(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new qr(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Fa(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},r={}){return this.rest.rpc(t,s,r)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,s;return Kn(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:a,storageKey:i,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Wn({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:a,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Sa(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,s,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zn=(n,t,s)=>new Yn(n,t,s),Qn="https://abgtunvbbtlhsjphsvqq.supabase.co",Xn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFiZ3R1bnZiYnRsaHNqcGhzdnFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNjIxODcsImV4cCI6MjA2NTgzODE4N30.ypdWuAOSQkv30M98pm_p0kx6JhIU-CCE9s-LcwX8gTQ",G=Zn(Qn,Xn),ei=j.createContext(void 0),Gs=j.createContext(void 0),Ft=()=>{const n=j.useContext(Gs);j.useContext(ei);{if(n===void 0)throw new Error("useAuth must be used within a DemoAuthProvider");return n}},ti=({children:n})=>{const[t,s]=j.useState(!0),[r,a]=j.useState(!1),i={id:"demo-admin-id",email:"admin@acmenonprofit.org",user_metadata:{full_name:"Sarah Johnson"}},u={user:t?i:null,session:t?{user:i,access_token:"demo-access-token"}:null,loading:r,signIn:async(h,m)=>{a(!0),await new Promise(g=>setTimeout(g,1e3)),s(!0),a(!1)},signUp:async(h,m)=>{a(!0),await new Promise(g=>setTimeout(g,1e3)),s(!0),a(!1)},signOut:async()=>{s(!1)}};return e.jsx(Gs.Provider,{value:u,children:n})},si=({onToggleMode:n,isSignUp:t})=>{const[s,r]=j.useState(""),[a,i]=j.useState(""),[o,l]=j.useState(!1),[c,d]=j.useState(!1),[u,h]=j.useState(null),{signIn:m,signUp:g}=Ft(),v=async b=>{b.preventDefault(),d(!0),h(null);try{t?(await g(s,a),alert("Account created successfully! You can now sign in."),n()):await m(s,a)}catch(x){console.error("Authentication error:",x);let p="An error occurred";x instanceof Error&&(x.message.includes("Invalid login credentials")?p="Invalid email or password":x.message.includes("Email not confirmed")?p="Please check your email and confirm your account":x.message.includes("User already registered")?p="An account with this email already exists":p=x.message),h(p)}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-blue-100",children:e.jsx(Gt,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900",children:t?"Create your account":"Sign in to Adminizer"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:t?"Join your organization":"Access your document management system"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:v,children:[u&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:b=>r(b.target.value),className:"pl-10 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your email",disabled:c})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx(Gt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{id:"password",name:"password",type:o?"text":"password",autoComplete:t?"new-password":"current-password",required:!0,value:a,onChange:b=>i(b.target.value),className:"pl-10 pr-10 block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password",disabled:c}),e.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:c,children:o?e.jsx(gt,{className:"h-5 w-5"}):e.jsx(_e,{className:"h-5 w-5"})})]})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:c?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?"Creating account...":"Signing in..."]}):t?"Create account":"Sign in"})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:n,className:"text-sm text-blue-600 hover:text-blue-500 font-medium",disabled:c,children:t?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})]})})},ri=({children:n})=>{const{user:t,loading:s}=Ft(),[r,a]=Se.useState(!1);return s?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):t?e.jsx(e.Fragment,{children:n}):e.jsx(si,{onToggleMode:()=>a(!r),isSignUp:r})},ai=[{id:"demo-doc-1",name:"Employee Handbook 2024.pdf",category:"HR",upload_date:"2024-01-15",expiry_date:"2024-12-31",size:2048576,status:"Active",file_path:"demo/employee-handbook.pdf",tags:["handbook","policies","hr"],description:"Updated employee handbook with new policies and procedures",organization_id:"demo-org-1",created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z"},{id:"demo-doc-2",name:"Q4 Financial Report.xlsx",category:"Accounting",upload_date:"2024-01-10",expiry_date:null,size:1024e3,status:"Active",file_path:"demo/q4-financial-report.xlsx",tags:["financial","quarterly","report"],description:"Fourth quarter financial performance report",organization_id:"demo-org-1",created_at:"2024-01-10T14:30:00Z",updated_at:"2024-01-10T14:30:00Z"},{id:"demo-doc-3",name:"Brand Guidelines.pdf",category:"Branding",upload_date:"2024-01-08",expiry_date:"2025-01-08",size:512e4,status:"Active",file_path:"demo/brand-guidelines.pdf",tags:["branding","design","guidelines"],description:"Official brand guidelines and design standards",organization_id:"demo-org-1",created_at:"2024-01-08T09:15:00Z",updated_at:"2024-01-08T09:15:00Z"},{id:"demo-doc-4",name:"Social Media Calendar.xlsx",category:"Social Media",upload_date:"2024-01-05",expiry_date:"2024-03-31",size:512e3,status:"Expiring Soon",file_path:"demo/social-media-calendar.xlsx",tags:["social media","calendar","planning"],description:"Q1 social media content calendar and posting schedule",organization_id:"demo-org-1",created_at:"2024-01-05T16:45:00Z",updated_at:"2024-01-05T16:45:00Z"},{id:"demo-doc-5",name:"Legal Compliance Checklist.pdf",category:"Legal",upload_date:"2023-12-20",expiry_date:"2023-12-31",size:256e3,status:"Overdue",file_path:"demo/legal-compliance.pdf",tags:["legal","compliance","checklist"],description:"Annual legal compliance requirements checklist",organization_id:"demo-org-1",created_at:"2023-12-20T11:20:00Z",updated_at:"2023-12-20T11:20:00Z"}],ni=()=>{const[n,t]=j.useState(ai),[s,r]=j.useState(!1),[a]=j.useState(null);return{documents:n,loading:s,error:a,uploadDocument:async(u,h)=>{r(!0),await new Promise(g=>setTimeout(g,1e3));const m={id:`demo-doc-${Date.now()}`,name:u.name,category:h.category,upload_date:new Date().toISOString().split("T")[0],expiry_date:h.expiryDate||null,size:u.size,status:"Active",file_path:`demo/${u.name}`,tags:h.tags,description:h.description||null,organization_id:"demo-org-1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return t(g=>[m,...g]),r(!1),m},updateDocument:async(u,h)=>{const m=n.find(v=>v.id===u);if(!m)throw new Error("Document not found");const g={...m,...h,updated_at:new Date().toISOString()};return t(v=>v.map(b=>b.id===u?g:b)),g},deleteDocument:async u=>{t(h=>h.filter(m=>m.id!==u))},downloadDocument:async(u,h)=>{const m=new Blob(["Demo file content"],{type:"text/plain"}),g=URL.createObjectURL(m),v=document.createElement("a");v.href=g,v.download=h,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(g)},refetch:async()=>{}}},ii=[{id:"demo-conn-1",provider_id:"google-workspace",user_id:"demo-admin-id",organization_id:"demo-org-1",access_token:"demo-access-token-1",refresh_token:"demo-refresh-token-1",expires_at:new Date(Date.now()+36e5).toISOString(),scopes:["https://www.googleapis.com/auth/userinfo.email"],is_active:!0,created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z"},{id:"demo-conn-2",provider_id:"youtube",user_id:"demo-admin-id",organization_id:"demo-org-1",access_token:"demo-access-token-2",refresh_token:"demo-refresh-token-2",expires_at:new Date(Date.now()+36e5).toISOString(),scopes:["https://www.googleapis.com/auth/youtube"],is_active:!0,created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z"}],oi=()=>{const[n,t]=j.useState(ii),[s,r]=j.useState(!1),[a,i]=j.useState(null);return{connections:n,loading:s,error:a,initiateOAuth:v=>{console.log(`Demo: Initiating OAuth for ${v}`),alert(`Demo: OAuth connection to ${v} would be initiated here`)},handleOAuthCallback:async(v,b,x)=>!0,disconnectProvider:async v=>{t(b=>b.filter(x=>x.id!==v))},getAccessToken:async v=>{const b=n.find(x=>x.provider_id===v&&x.is_active);return(b==null?void 0:b.access_token)||null},isConnected:v=>n.some(b=>b.provider_id===v&&b.is_active),getConnection:v=>n.find(b=>b.provider_id===v&&b.is_active)||null,launchService:async(v,b)=>{console.log(`Demo: Launching ${v} service`),window.open(b,"_blank")},refetch:async()=>{}}},Vs={id:"demo-admin-id",email:"admin@demo.com",full_name:"Demo Administrator",role:"master_admin",organization_id:"demo-org-1",is_active:!0,invited_by:null,invited_at:null,last_login:new Date().toISOString(),created_at:"2024-01-01T00:00:00Z",updated_at:new Date().toISOString()},us={id:"demo-org-1",name:"Demo Organization",created_by:"demo-admin-id",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-01T00:00:00Z"},li=[Vs,{id:"demo-user-1",email:"user1@demo.com",full_name:"Demo User 1",role:"user",organization_id:"demo-org-1",is_active:!0,invited_by:"demo-admin-id",invited_at:"2024-01-02T00:00:00Z",last_login:"2024-01-15T10:00:00Z",created_at:"2024-01-02T00:00:00Z",updated_at:"2024-01-02T00:00:00Z"},{id:"demo-user-2",email:"user2@demo.com",full_name:"Demo User 2",role:"admin",organization_id:"demo-org-1",is_active:!0,invited_by:"demo-admin-id",invited_at:"2024-01-03T00:00:00Z",last_login:"2024-01-14T15:30:00Z",created_at:"2024-01-03T00:00:00Z",updated_at:"2024-01-03T00:00:00Z"}],ci=[{id:"demo-invite-1",email:"newuser@demo.com",role:"user",organization_id:"demo-org-1",invited_by:"demo-admin-id",token:"demo-token-123",expires_at:new Date(Date.now()+7*24*60*60*1e3).toISOString(),accepted_at:null,created_at:new Date().toISOString()}],di=()=>{const[n]=j.useState(Vs),[t]=j.useState(us),[s,r]=j.useState(li),[a,i]=j.useState(ci),[o]=j.useState(!1),[l]=j.useState(null),c=async w=>us,d=async w=>{const f={id:`demo-invite-${Date.now()}`,email:w.email,role:w.role,organization_id:"demo-org-1",invited_by:"demo-admin-id",token:`demo-token-${Date.now()}`,expires_at:new Date(Date.now()+6048e5).toISOString(),accepted_at:null,created_at:new Date().toISOString()};return i(y=>[f,...y]),f},u=async(w,f)=>({user:{id:"demo-new-user",email:"newuser@demo.com"}}),h=async(w,f)=>{r(y=>y.map(k=>k.id===w?{...k,role:f,updated_at:new Date().toISOString()}:k))},m=async w=>{r(f=>f.map(y=>y.id===w?{...y,is_active:!1,updated_at:new Date().toISOString()}:y))},g=async w=>{r(f=>f.map(y=>y.id===w?{...y,is_active:!0,updated_at:new Date().toISOString()}:y))},v=async w=>{i(f=>f.filter(y=>y.id!==w))},b=async()=>{},x=(n==null?void 0:n.role)==="master_admin"||(n==null?void 0:n.role)==="admin",p=(n==null?void 0:n.role)==="master_admin";return{userProfile:n,organization:t,users:s,invitations:a,loading:o,error:l,isAdmin:x,isMasterAdmin:p,createOrganization:c,inviteUser:d,acceptInvitation:u,updateUserRole:h,deactivateUser:m,reactivateUser:g,cancelInvitation:v,refetch:b}},ve={"google-workspace":{id:"google-workspace",name:"Google Workspace",description:"Access Gmail, Drive, Calendar, and other Google services",category:"Productivity",authUrl:"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:"https://oauth2.googleapis.com/token",scopes:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/calendar.readonly"],redirectUri:`${window.location.origin}/oauth/callback/google-workspace`,isConfigured:!1,supportsOAuth:!0},"google-search-console":{id:"google-search-console",name:"Google Search Console",description:"Monitor and optimize your website's search performance",category:"Analytics",authUrl:"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:"https://oauth2.googleapis.com/token",scopes:["https://www.googleapis.com/auth/webmasters.readonly","https://www.googleapis.com/auth/webmasters"],redirectUri:`${window.location.origin}/oauth/callback/google-search-console`,isConfigured:!1,supportsOAuth:!0},youtube:{id:"youtube",name:"YouTube",description:"Video hosting and management platform",category:"Video Platform",authUrl:"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:"https://oauth2.googleapis.com/token",scopes:["https://www.googleapis.com/auth/youtube","https://www.googleapis.com/auth/youtube.upload","https://www.googleapis.com/auth/youtube.readonly","https://www.googleapis.com/auth/youtubepartner"],redirectUri:`${window.location.origin}/oauth/callback/youtube`,isConfigured:!1,supportsOAuth:!0},"microsoft-365":{id:"microsoft-365",name:"Microsoft 365",description:"Access Outlook, OneDrive, Teams, and other Microsoft services",category:"Productivity",authUrl:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",tokenUrl:"https://login.microsoftonline.com/common/oauth2/v2.0/token",scopes:["https://graph.microsoft.com/User.Read","https://graph.microsoft.com/Files.Read","https://graph.microsoft.com/Calendars.Read"],redirectUri:`${window.location.origin}/oauth/callback/microsoft-365`,isConfigured:!1,supportsOAuth:!0},quickbooks:{id:"quickbooks",name:"QuickBooks Online",description:"Access your QuickBooks accounting data",category:"Accounting",authUrl:"https://appcenter.intuit.com/connect/oauth2",tokenUrl:"https://oauth.platform.intuit.com/oauth2/v1/tokens/bearer",scopes:["com.intuit.quickbooks.accounting"],redirectUri:`${window.location.origin}/oauth/callback/quickbooks`,isConfigured:!1,supportsOAuth:!0},slack:{id:"slack",name:"Slack",description:"Access your Slack workspace",category:"Communication",authUrl:"https://slack.com/oauth/v2/authorize",tokenUrl:"https://slack.com/api/oauth.v2.access",scopes:["channels:read","chat:write","users:read"],redirectUri:`${window.location.origin}/oauth/callback/slack`,isConfigured:!1,supportsOAuth:!0},mailchimp:{id:"mailchimp",name:"Mailchimp",description:"Access your Mailchimp marketing campaigns",category:"Marketing",authUrl:"https://login.mailchimp.com/oauth2/authorize",tokenUrl:"https://login.mailchimp.com/oauth2/token",scopes:[],redirectUri:`${window.location.origin}/oauth/callback/mailchimp`,isConfigured:!1,supportsOAuth:!0},gusto:{id:"gusto",name:"Gusto",description:"Payroll, benefits, and HR management",category:"Payroll",authUrl:"https://api.gusto-demo.com/oauth/authorize",tokenUrl:"https://api.gusto-demo.com/oauth/token",scopes:["employee:read","company:read","payroll:read"],redirectUri:`${window.location.origin}/oauth/callback/gusto`,isConfigured:!1,supportsOAuth:!0},bamboohr:{id:"bamboohr",name:"BambooHR",description:"HR software with employee data management",category:"HRIS",authUrl:"https://api.bamboohr.com/api/gateway.php/[company]/v1/login",tokenUrl:"https://api.bamboohr.com/api/gateway.php/[company]/v1/login",scopes:["employee:read","company:read"],redirectUri:`${window.location.origin}/oauth/callback/bamboohr`,isConfigured:!1,supportsOAuth:!0},github:{id:"github",name:"GitHub",description:"Code repository and collaboration platform",category:"Development",authUrl:"https://github.com/login/oauth/authorize",tokenUrl:"https://github.com/login/oauth/access_token",scopes:["repo","user:email","read:org"],redirectUri:`${window.location.origin}/oauth/callback/github`,isConfigured:!1,supportsOAuth:!0}},ue=class ue{static getInstance(){return ue.instance||(ue.instance=new ue),ue.instance}generateAuthUrl(t,s){const r=ve[t];if(!r)throw new Error(`Provider ${t} not found`);const a=new URLSearchParams({client_id:r.clientId||"",redirect_uri:r.redirectUri,scope:r.scopes.join(" "),response_type:"code",access_type:"offline",prompt:"consent",state:s||crypto.randomUUID()});return`${r.authUrl}?${a.toString()}`}async exchangeCodeForToken(t,s){const r=ve[t];if(!r)throw new Error(`Provider ${t} not found`);const a=await this.getOAuthConfig(t);if(!a)throw new Error(`OAuth not configured for ${t}`);const i={client_id:a.client_id,client_secret:a.client_secret,code:s,grant_type:"authorization_code",redirect_uri:r.redirectUri},o=await fetch(r.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams(i)});if(!o.ok)throw new Error(`Token exchange failed: ${o.statusText}`);const l=await o.json();return l.expires_at=Date.now()+l.expires_in*1e3,l}async storeConnection(t,s,r,a){const{data:i,error:o}=await G.from("oauth_connections").insert({provider_id:t,user_id:r,organization_id:a,access_token:s.access_token,refresh_token:s.refresh_token,expires_at:new Date(s.expires_at).toISOString(),scopes:ve[t].scopes,is_active:!0}).select().single();if(o)throw o;return i}async getConnection(t,s){const{data:r,error:a}=await G.from("oauth_connections").select("*").eq("provider_id",t).eq("user_id",s).eq("is_active",!0).limit(1);if(a)throw a;return r&&r.length>0?r[0]:null}async refreshToken(t){const s=ve[t.provider_id];if(!s||!t.refresh_token)throw new Error("Cannot refresh token");const r=await this.getOAuthConfig(t.provider_id);if(!r)throw new Error(`OAuth not configured for ${t.provider_id}`);const a={client_id:r.client_id,client_secret:r.client_secret,refresh_token:t.refresh_token,grant_type:"refresh_token"},i=await fetch(s.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams(a)});if(!i.ok)throw new Error(`Token refresh failed: ${i.statusText}`);const o=await i.json();return o.expires_at=Date.now()+o.expires_in*1e3,await G.from("oauth_connections").update({access_token:o.access_token,refresh_token:o.refresh_token||t.refresh_token,expires_at:new Date(o.expires_at).toISOString()}).eq("id",t.id),o}async getValidToken(t,s){const r=await this.getConnection(t,s);if(!r)return null;const a=Date.now();if(new Date(r.expires_at).getTime()-a<5*60*1e3)try{return(await this.refreshToken(r)).access_token}catch(o){return console.error("Failed to refresh token:",o),null}return r.access_token}async revokeConnection(t){const{error:s}=await G.from("oauth_connections").update({is_active:!1}).eq("id",t);if(s)throw s}async getOAuthConfig(t){const{data:s,error:r}=await G.from("oauth_configs").select("*").eq("provider_id",t).limit(1);if(r)throw r;return s&&s.length>0?s[0]:null}supportsOAuth(t){const s=ve[t];return(s==null?void 0:s.supportsOAuth)||!1}async getConfiguredProviders(t){const{data:s,error:r}=await G.from("oauth_configs").select("provider_id").eq("organization_id",t);if(r)throw r;return s.map(a=>a.provider_id)}};Bt(ue,"instance");let Tt=ue;const ui=Tt.getInstance(),ie=ni,zt=oi,W=di,Hs="2.1.0",hi=()=>({version:Hs,buildDate:new Date().toISOString(),environment:"demo"}),mi=()=>{const{documents:n,loading:t}=ie(),{userProfile:s,organization:r,loading:a}=W(),i=me(),o=t||a,l=hi(),c=n.length,d=n.filter(p=>{if(!p.expiry_date)return!1;const w=new Date(p.expiry_date),f=ft(new Date,30);return rr(w,new Date)&&we(w,f)}).length,u=n.filter(p=>p.expiry_date?we(new Date(p.expiry_date),new Date):!1).length,h=[{label:"Total Documents",value:c.toString(),icon:I,color:"bg-blue-500"},{label:"Expiring Soon",value:d.toString(),icon:pt,color:"bg-yellow-500"},{label:"Overdue",value:u.toString(),icon:We,color:"bg-red-500"},{label:"Categories",value:new Set(n.map(p=>p.category)).size.toString(),icon:ae,color:"bg-green-500"}],m=[{id:"foster-adopt",name:"Foster & Adopt",description:"Foster care and adoption services",icon:ar,color:"bg-pink-600 hover:bg-pink-700",textColor:"text-pink-600",bgColor:"bg-pink-50",route:"/department/foster-adopt"},{id:"r-kids",name:"R/Kids",description:"Children's ministry and programs",icon:nr,color:"bg-blue-600 hover:bg-blue-700",textColor:"text-blue-600",bgColor:"bg-blue-50",route:"/department/r-kids"},{id:"r-youth",name:"R/Youth",description:"Youth ministry and activities",icon:ir,color:"bg-green-600 hover:bg-green-700",textColor:"text-green-600",bgColor:"bg-green-50",route:"/department/r-youth"},{id:"creative-media",name:"Creative Media",description:"Media production and creative services",icon:or,color:"bg-purple-600 hover:bg-purple-700",textColor:"text-purple-600",bgColor:"bg-purple-50",route:"/department/creative-media"},{id:"cge",name:"CGE",description:"Christian Growth & Education",icon:lr,color:"bg-indigo-600 hover:bg-indigo-700",textColor:"text-indigo-600",bgColor:"bg-indigo-50",route:"/department/cge"},{id:"worship",name:"Worship",description:"Worship ministry and music",icon:cr,color:"bg-orange-600 hover:bg-orange-700",textColor:"text-orange-600",bgColor:"bg-orange-50",route:"/department/worship"},{id:"sunday-production",name:"Sunday Production",description:"Sunday service production and technical",icon:dr,color:"bg-red-600 hover:bg-red-700",textColor:"text-red-600",bgColor:"bg-red-50",route:"/department/sunday-production"},{id:"elder-board",name:"Elder Board",description:"Elder board governance and decisions",icon:Ne,color:"bg-gray-600 hover:bg-gray-700",textColor:"text-gray-600",bgColor:"bg-gray-50",route:"/department/elder-board"},{id:"deacon-board",name:"Deacon Board",description:"Deacon board service and support",icon:ur,color:"bg-cyan-600 hover:bg-cyan-700",textColor:"text-cyan-600",bgColor:"bg-cyan-50",route:"/department/deacon-board"}],g=n.slice(0,5),v=n.filter(p=>p.expiry_date).sort((p,w)=>new Date(p.expiry_date).getTime()-new Date(w.expiry_date).getTime()).slice(0,5),b=p=>{i(p)},x=()=>{i("/operations")};return!o&&s&&!s.organization_id?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Welcome to Adminizer"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Let's get you set up with your organization"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-6 mx-auto w-24 h-24 flex items-center justify-center mb-6",children:e.jsx(ae,{className:"h-12 w-12 text-blue-600"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Set up your organization"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create or join an organization to start managing documents and collaborating with your team."}),e.jsx("div",{className:"flex justify-center space-x-4",children:e.jsx("button",{onClick:()=>i("/users"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Set Up Organization"})})]})]}):o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Welcome to your organization dashboard"})]}),e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((p,w)=>e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("div",{className:"h-16 bg-gray-200 rounded"})},w))}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-8",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(8)].map((p,w)=>e.jsx("div",{className:"h-48 bg-gray-200 rounded"},w))})]})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome to your organization dashboard",r&&e.jsx("span",{className:"block text-sm text-blue-600 mt-1",children:r.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsxs("span",{children:["v",Hs]}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:l.environment})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map(p=>e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`${p.color} p-3 rounded-lg`,children:e.jsx(p.icon,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:p.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.value})]})]})},p.label))}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Business Departments"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Access your department-specific tools and resources"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:m.map(p=>e.jsxs("button",{onClick:()=>b(p.route),className:"group relative overflow-hidden rounded-xl border border-gray-200 bg-white p-6 text-left transition-all duration-200 hover:border-gray-300 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx("div",{className:`inline-flex h-12 w-12 items-center justify-center rounded-lg ${p.bgColor} mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(p.icon,{className:`h-6 w-6 ${p.textColor}`})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-gray-700",children:p.name}),e.jsx("p",{className:"text-sm text-gray-600 group-hover:text-gray-500",children:p.description}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-gradient-to-r from-transparent via-gray-200 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]},p.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Business Operations"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Access administrative and operational tools"})]}),e.jsxs("button",{onClick:x,className:"group relative overflow-hidden rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-8 py-4 text-white transition-all duration-200 hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ms,{className:"h-6 w-6"}),e.jsx("span",{className:"text-lg font-semibold",children:"Operations Center"})]}),e.jsx("div",{className:"absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity duration-200"})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-blue-100 rounded-lg p-3",children:e.jsx(H,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Operations Center"}),e.jsx("p",{className:"text-blue-800 mb-4",children:"Access HR, Accounting, Legal, IT, and other administrative functions. Manage integrations, compliance, and organizational operations."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 rounded-full text-sm",children:"HR Management"}),e.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 rounded-full text-sm",children:"Financial Operations"}),e.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 rounded-full text-sm",children:"Legal Compliance"}),e.jsx("span",{className:"px-3 py-1 bg-blue-200 text-blue-800 rounded-full text-sm",children:"IT & Technology"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Documents"}),e.jsx("button",{onClick:()=>i("/documents"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View all"})]}),e.jsx("div",{className:"space-y-3",children:g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"No documents uploaded yet"}),e.jsx("button",{onClick:()=>i("/upload"),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Upload your first document"})]}):g.map(p=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.name}),e.jsx("p",{className:"text-sm text-gray-600",children:p.category})]}),e.jsx("span",{className:"text-xs text-gray-500",children:D(new Date(p.created_at),"MMM dd, yyyy")})]},p.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Renewals"}),e.jsx("button",{onClick:()=>i("/documents"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Manage"})]}),e.jsx("div",{className:"space-y-3",children:v.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pt,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"No documents with expiry dates"}),e.jsx("button",{onClick:()=>i("/upload"),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Add documents with expiry dates"})]}):v.map(p=>{const w=new Date(p.expiry_date),f=we(w,new Date),y=!f&&we(w,ft(new Date,30));return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Expires: ",D(w,"MMM dd, yyyy")]})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${f?"bg-red-100 text-red-800":y?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:f?"overdue":y?"soon":"ok"})]},p.id)})})]})]})]})},Js=({isOpen:n,onClose:t,document:s,onDownload:r})=>{const[a,i]=j.useState(null),[o,l]=j.useState(!1),[c,d]=j.useState(null);if(j.useEffect(()=>{if(!n||!s){i(null),d(null);return}(async()=>{l(!0),d(null);try{const{data:x,error:p}=await G.storage.from("documents").createSignedUrl(s.file_path,3600);if(p){console.error("Error creating signed URL:",p);const{data:w}=G.storage.from("documents").getPublicUrl(s.file_path);i(w.publicUrl)}else i(x.signedUrl)}catch(x){console.error("Error getting file URL:",x),d("Failed to load document")}finally{l(!1)}})()},[n,s]),!n||!s)return null;const u=b=>{var x;return((x=b.split(".").pop())==null?void 0:x.toLowerCase())||""},m=(b=>{const x=u(b);return["pdf"].includes(x)?"pdf":["jpg","jpeg","png","gif","webp","svg"].includes(x)?"image":["mp4","webm","ogg","mov"].includes(x)?"video":["mp3","wav","ogg","m4a"].includes(x)?"audio":["txt","md"].includes(x)?"text":["doc","docx","xls","xlsx","ppt","pptx"].includes(x)?"office":"other"})(s.name),g=b=>{if(b===0)return"0 Bytes";const x=1024,p=["Bytes","KB","MB","GB"],w=Math.floor(Math.log(b)/Math.log(x));return parseFloat((b/Math.pow(x,w)).toFixed(2))+" "+p[w]},v=()=>{if(o)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading document..."})]})});if(c||!a)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-6 mb-4",children:e.jsx(xt,{className:"h-12 w-12 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to load document"}),e.jsx("p",{className:"text-gray-600 mb-6",children:c||"There was an issue loading this document. You can try downloading it instead."}),e.jsxs("button",{onClick:()=>r(s.file_path,s.name),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:"Download File"})]})]});switch(m){case"pdf":return e.jsx("div",{className:"w-full h-full",children:e.jsx("iframe",{src:`${a}#toolbar=1&navpanes=1&scrollbar=1`,className:"w-full h-full border-0",title:s.name,onError:()=>d("PDF could not be displayed")})});case"image":return e.jsx("div",{className:"flex items-center justify-center h-full p-4",children:e.jsx("img",{src:a,alt:s.name,className:"max-w-full max-h-full object-contain rounded-lg shadow-lg",onError:()=>d("Image could not be displayed")})});case"video":return e.jsx("div",{className:"flex items-center justify-center h-full p-4",children:e.jsx("video",{src:a,controls:!0,className:"max-w-full max-h-full rounded-lg shadow-lg",onError:()=>d("Video could not be displayed"),children:"Your browser does not support the video tag."})});case"audio":return e.jsx("div",{className:"flex items-center justify-center h-full p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-6 mb-4 mx-auto w-24 h-24 flex items-center justify-center",children:e.jsxs("svg",{className:"h-12 w-12 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12a7.971 7.971 0 00-1.343-4.243 1 1 0 010-1.414z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M13.828 8.172a1 1 0 011.414 0A5.983 5.983 0 0117 12a5.983 5.983 0 01-1.758 3.828 1 1 0 11-1.414-1.414A3.987 3.987 0 0015 12a3.987 3.987 0 00-1.172-2.828 1 1 0 010-1.414z",clipRule:"evenodd"})]})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s.name}),e.jsx("audio",{src:a,controls:!0,className:"w-full max-w-md mx-auto",onError:()=>d("Audio could not be played"),children:"Your browser does not support the audio tag."})]})});case"text":return e.jsx("div",{className:"w-full h-full p-4",children:e.jsx("iframe",{src:a,className:"w-full h-full border border-gray-200 rounded-lg",title:s.name,onError:()=>d("Text file could not be displayed")})});case"office":return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-6 mb-4",children:e.jsx("svg",{className:"h-12 w-12 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Office Document"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This document type requires downloading to view. Click below to download and open with the appropriate application."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>r(s.file_path,s.name),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:"Download File"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Or try opening in"," ",e.jsx("a",{href:`https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(a)}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline",children:"Office Online"})]})]})]});default:return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-6 mb-4",children:e.jsx(xt,{className:"h-12 w-12 text-gray-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Preview not available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This file type cannot be previewed in the browser. Download the file to view its content."}),e.jsxs("button",{onClick:()=>r(s.file_path,s.name),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(he,{className:"h-4 w-4"}),e.jsx("span",{children:"Download File"})]})]})}};return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-75",onClick:t}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:s.category}),e.jsx("span",{children:g(s.size)}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>r(s.file_path,s.name),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Download",children:e.jsx(he,{className:"h-5 w-5"})}),e.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Close",children:e.jsx(J,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:v()})]})})]})},gi=({isOpen:n,onClose:t,document:s})=>{const{updateDocument:r}=ie(),[a,i]=j.useState(!1),[o,l]=j.useState({category:(s==null?void 0:s.category)||"",expiryDate:(s==null?void 0:s.expiry_date)||"",tags:(s==null?void 0:s.tags.join(", "))||"",description:(s==null?void 0:s.description)||""}),c=["HR","Accounting","Branding","Social Media","Communications","Volunteer/People Management","Streaming: Video & Podcast","Reports","Governance","Legal","Funding","Financial","Operations","Other"];Se.useEffect(()=>{s&&l({category:s.category,expiryDate:s.expiry_date||"",tags:s.tags.join(", "),description:s.description||""})},[s]);const d=async u=>{if(u.preventDefault(),!!s){i(!0);try{const h=o.tags.split(",").map(m=>m.trim()).filter(m=>m.length>0);await r(s.id,{category:o.category,expiry_date:o.expiryDate||null,tags:h,description:o.description||null}),t()}catch(h){alert("Failed to update document: "+(h instanceof Error?h.message:"Unknown error"))}finally{i(!1)}}};return!n||!s?null:e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Document"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.name})]}),e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:d,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Qe,{className:"inline h-4 w-4 mr-1"}),"Category"]}),e.jsx("select",{value:o.category,onChange:u=>l(h=>({...h,category:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:a,children:c.map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Xe,{className:"inline h-4 w-4 mr-1"}),"Expiry Date"]}),e.jsx("input",{type:"date",value:o.expiryDate,onChange:u=>l(h=>({...h,expiryDate:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),e.jsx("input",{type:"text",value:o.tags,onChange:u=>l(h=>({...h,tags:u.target.value})),placeholder:"Enter tags separated by commas",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(I,{className:"inline h-4 w-4 mr-1"}),"Description"]}),e.jsx("textarea",{value:o.description,onChange:u=>l(h=>({...h,description:u.target.value})),rows:3,placeholder:"Add a description for this document",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:a,children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:a?"Saving...":"Save Changes"})]})]})]})]})})]})},fi=({isOpen:n,onClose:t,document:s,onSave:r})=>{const[a,i]=j.useState(""),[o,l]=j.useState(!1),[c,d]=j.useState(!1),[u,h]=j.useState(null);j.useEffect(()=>{if(!n||!s){i(""),h(null);return}(async()=>{l(!0),h(null);try{const{data:p,error:w}=await G.storage.from("documents").download(s.file_path);if(w)throw w;const f=await p.text();i(f)}catch(p){console.error("Error loading document content:",p),h("Failed to load document content")}finally{l(!1)}})()},[n,s]);const m=async()=>{if(s){d(!0);try{const x=new Blob([a],{type:"text/plain"}),{error:p}=await G.storage.from("documents").update(s.file_path,x);if(p)throw p;r(a),t()}catch(x){console.error("Error saving document:",x),h("Failed to save document")}finally{d(!1)}}},g=()=>{if(!s)return;const x=new Blob([a],{type:"text/plain"}),p=URL.createObjectURL(x),w=document.createElement("a");w.href=p,w.download=s.name,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(p)};if(!n||!s)return null;const v=x=>{var p;return((p=x.split(".").pop())==null?void 0:p.toLowerCase())||""};return(x=>{const p=v(x);return["txt","md","csv","json","xml","html","css","js","ts","jsx","tsx"].includes(p)})(s.name)?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 truncate",children:["Editing: ",s.name]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:s.category}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:g,className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Download",disabled:o,children:e.jsx(he,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:m,disabled:c||o,className:"flex items-center space-x-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",title:"Save",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:c?"Saving...":"Save"})]}),e.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Close",children:e.jsx(J,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden p-4",children:o?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading document..."})]})}):u?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-6 mb-4 mx-auto w-24 h-24 flex items-center justify-center",children:e.jsx(I,{className:"h-12 w-12 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Document"}),e.jsx("p",{className:"text-gray-600 mb-4",children:u}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})}):e.jsx("textarea",{value:a,onChange:x=>i(x.target.value),className:"w-full h-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none font-mono text-sm",placeholder:"Document content will appear here...",disabled:c})})]})})]}):e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"File Not Editable"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This file type cannot be edited in the browser. Only text-based files (txt, md, csv, etc.) can be edited."}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})})]})},pi=()=>{const[n,t]=j.useState(""),[s,r]=j.useState("all"),[a,i]=j.useState(!1),[o,l]=j.useState(!1),[c,d]=j.useState(!1),[u,h]=j.useState(null),{documents:m,loading:g,error:v,deleteDocument:b,downloadDocument:x}=ie(),p=["all","HR","Accounting","Branding","Social Media","Communications","Volunteer/People Management","Streaming: Video & Podcast","Reports","Governance","Legal","Funding","Financial","Operations","Other"],w=m.filter(_=>{const P=_.name.toLowerCase().includes(n.toLowerCase()),V=s==="all"||_.category===s;return P&&V}),f=_=>{if(_===0)return"0 Bytes";const P=1024,V=["Bytes","KB","MB","GB"],Oe=Math.floor(Math.log(_)/Math.log(P));return parseFloat((_/Math.pow(P,Oe)).toFixed(2))+" "+V[Oe]},y=_=>{var P;return((P=_.split(".").pop())==null?void 0:P.toLowerCase())||""},k=_=>{const P=y(_);return["txt","md","csv","json","xml","html","css","js","ts","jsx","tsx"].includes(P)},A=async(_,P,V)=>{if(window.confirm(`Are you sure you want to delete "${V}"?`))try{await b(_,P)}catch(Oe){alert("Failed to delete document: "+(Oe instanceof Error?Oe.message:"Unknown error"))}},O=async(_,P)=>{try{await x(_,P)}catch(V){alert("Failed to download document: "+(V instanceof Error?V.message:"Unknown error"))}},F=_=>{h(_),i(!0)},K=_=>{h(_),l(!0)},N=_=>{h(_),d(!0)},$=()=>{i(!1),h(null)},X=()=>{l(!1),h(null)},oe=()=>{d(!1),h(null)},Ee=()=>{console.log("Document content saved")};return g?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),e.jsx("p",{className:"text-gray-600",children:"Manage and organize your documents"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((_,P)=>e.jsx("div",{className:"h-4 bg-gray-200 rounded"},P))})]})})]}):v?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),e.jsx("p",{className:"text-gray-600",children:"Manage and organize your documents"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("p",{className:"text-red-600 mb-4",children:["Error loading documents: ",v]}),e.jsx("p",{className:"text-gray-600",children:"Please make sure Supabase is properly configured."})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),e.jsx("p",{className:"text-gray-600",children:"Manage and organize your documents"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:n,onChange:_=>t(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hr,{className:"text-gray-400 h-4 w-4"}),e.jsx("select",{value:s,onChange:_=>r(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:p.map(_=>e.jsx("option",{value:_,children:_==="all"?"All Categories":_},_))})]})]}),w.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No documents found. Upload your first document to get started!"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Category"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Upload Date"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Expiry Date"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Size"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{children:w.map(_=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsxs("td",{className:"py-3 px-4",children:[e.jsx("button",{onClick:()=>F(_),className:"font-medium text-blue-600 hover:text-blue-800 hover:underline text-left",children:_.name}),_.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[_.tags.slice(0,3).map((P,V)=>e.jsx("span",{className:"px-1 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:P},V)),_.tags.length>3&&e.jsxs("span",{className:"px-1 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:["+",_.tags.length-3]})]})]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:_.category})}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:D(new Date(_.upload_date),"MMM dd, yyyy")}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:_.expiry_date?D(new Date(_.expiry_date),"MMM dd, yyyy"):"N/A"}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:f(_.size)}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${_.status==="Active"?"bg-green-100 text-green-800":_.status==="Expiring Soon"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:_.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>F(_),className:"p-1 text-gray-400 hover:text-blue-600",title:"View",children:e.jsx(_e,{size:16})}),e.jsx("button",{onClick:()=>K(_),className:"p-1 text-gray-400 hover:text-purple-600",title:"Edit Properties",children:e.jsx(H,{size:16})}),k(_.name)&&e.jsx("button",{onClick:()=>N(_),className:"p-1 text-gray-400 hover:text-orange-600",title:"Edit Content",children:e.jsx(mr,{size:16})}),e.jsx("button",{onClick:()=>O(_.file_path,_.name),className:"p-1 text-gray-400 hover:text-green-600",title:"Download",children:e.jsx(he,{size:16})}),e.jsx("button",{onClick:()=>A(_.id,_.file_path,_.name),className:"p-1 text-gray-400 hover:text-red-600",title:"Delete",children:e.jsx(gr,{size:16})})]})})]},_.id))})]})})]}),e.jsx(Js,{isOpen:a,onClose:$,document:u,onDownload:O}),e.jsx(gi,{isOpen:o,onClose:X,document:u}),e.jsx(fi,{isOpen:c,onClose:oe,document:u,onSave:Ee})]})},xi=()=>{const[n,t]=j.useState(!1),[s,r]=j.useState([]),[a,i]=j.useState(!1),[o,l]=j.useState({category:"",expiryDate:"",tags:"",description:""}),{uploadDocument:c}=ie(),d=me(),u=["HR","Accounting","Branding","Social Media","Communications","Volunteer/People Management","Streaming: Video & Podcast","Reports","Governance","Legal","Funding","Financial","Operations","Other"],h=p=>{p.preventDefault(),p.stopPropagation(),p.type==="dragenter"||p.type==="dragover"?t(!0):p.type==="dragleave"&&t(!1)},m=p=>{if(p.preventDefault(),p.stopPropagation(),t(!1),p.dataTransfer.files&&p.dataTransfer.files[0]){const w=Array.from(p.dataTransfer.files);r(f=>[...f,...w])}},g=p=>{if(p.target.files){const w=Array.from(p.target.files);r(f=>[...f,...w])}},v=p=>{r(w=>w.filter((f,y)=>y!==p))},b=async p=>{if(p.preventDefault(),s.length===0){alert("Please select at least one file to upload");return}if(!o.category){alert("Please select a category");return}i(!0);try{const w=o.tags.split(",").map(f=>f.trim()).filter(f=>f.length>0);for(const f of s)await c(f,{category:o.category,expiryDate:o.expiryDate||void 0,tags:w,description:o.description||void 0});r([]),l({category:"",expiryDate:"",tags:"",description:""}),alert(`Successfully uploaded ${s.length} document(s)!`),d("/documents")}catch(w){alert("Upload failed: "+(w instanceof Error?w.message:"Unknown error"))}finally{i(!1)}},x=p=>{if(p===0)return"0 Bytes";const w=1024,f=["Bytes","KB","MB","GB"],y=Math.floor(Math.log(p)/Math.log(w));return parseFloat((p/Math.pow(w,y)).toFixed(2))+" "+f[y]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Upload Documents"}),e.jsx("p",{className:"text-gray-600",children:"Add new documents to your organization's repository"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"File Upload"}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-8 text-center transition-colors ${n?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:h,onDragLeave:h,onDragOver:h,onDrop:m,children:[e.jsx(Dt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drop files here or click to browse"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Supports PDF, DOC, DOCX, XLS, XLSX, and image files up to 10MB"}),e.jsx("input",{type:"file",multiple:!0,onChange:g,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif",disabled:a})]}),s.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Selected Files"}),e.jsx("div",{className:"space-y-2",children:s.map((p,w)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.name}),e.jsx("p",{className:"text-xs text-gray-600",children:x(p.size)})]})]}),e.jsx("button",{type:"button",onClick:()=>v(w),className:"p-1 text-gray-400 hover:text-red-600",disabled:a,children:e.jsx(J,{size:16})})]},w))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Qe,{className:"inline h-4 w-4 mr-1"}),"Category *"]}),e.jsxs("select",{value:o.category,onChange:p=>l(w=>({...w,category:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:a,children:[e.jsx("option",{value:"",children:"Select a category"}),u.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Xe,{className:"inline h-4 w-4 mr-1"}),"Expiry Date (Optional)"]}),e.jsx("input",{type:"date",value:o.expiryDate,onChange:p=>l(w=>({...w,expiryDate:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (Optional)"}),e.jsx("input",{type:"text",value:o.tags,onChange:p=>l(w=>({...w,tags:p.target.value})),placeholder:"Enter tags separated by commas",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{value:o.description,onChange:p=>l(w=>({...w,description:p.target.value})),rows:3,placeholder:"Add a description for this document",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>d("/documents"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:a,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:s.length===0||a,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:a?"Uploading...":"Upload Documents"})]})]})]})},bi=({currentLogo:n,onLogoChange:t,isAdmin:s})=>{const[r,a]=j.useState(!1),[i,o]=j.useState(!1),[l,c]=j.useState(!1),d=j.useRef(null),u=async b=>{if(b){if(!b.type.includes("svg")){alert("Please upload an SVG file only");return}if(b.size>1024*1024){alert("File size must be less than 1MB");return}a(!0);try{const x=new FileReader;x.onload=p=>{var f;const w=(f=p.target)==null?void 0:f.result;localStorage.setItem("custom-logo",w),t(w),o(!1),a(!1)},x.readAsDataURL(b)}catch(x){console.error("Error uploading logo:",x),alert("Failed to upload logo"),a(!1)}}},h=b=>{b.preventDefault(),b.stopPropagation(),c(!1);const x=b.dataTransfer.files;x&&x[0]&&u(x[0])},m=b=>{b.preventDefault(),b.stopPropagation(),b.type==="dragenter"||b.type==="dragover"?c(!0):b.type==="dragleave"&&c(!1)},g=b=>{const x=b.target.files;x&&x[0]&&u(x[0])},v=()=>{localStorage.removeItem("custom-logo"),t(null),o(!1)};return s?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o(!0),className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Upload Custom Logo",children:e.jsx(fr,{className:"h-4 w-4"})}),i&&e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:()=>o(!1)}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload Custom Logo"}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[n?e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Logo"}),e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"h-8 flex items-center",dangerouslySetInnerHTML:{__html:n.startsWith("data:")?atob(n.split(",")[1]):n}}),e.jsx("button",{onClick:v,className:"text-red-600 hover:text-red-700 text-sm",children:"Remove"})]})]}):null,e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-8 text-center transition-colors ${l?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:m,onDragLeave:m,onDragOver:m,onDrop:h,children:[e.jsx(Dt,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drop SVG file here or click to browse"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"SVG files only, max 1MB"}),e.jsx("input",{ref:d,type:"file",accept:".svg,image/svg+xml",onChange:g,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:r}),r&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]}),e.jsx("div",{className:"mt-6 bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(bt,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Logo Guidelines"}),e.jsxs("ul",{className:"mt-1 text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:" Use SVG format for best quality"}),e.jsx("li",{children:" Recommended height: 24-32px"}),e.jsx("li",{children:" Keep file size under 1MB"}),e.jsx("li",{children:' Logo will replace "Adminizer" text'})]})]})]})})]})]})})]})]}):null},yi=({logoUrl:n,fallbackText:t="Adminizer"})=>{const[s,r]=Se.useState(!1),a=()=>{r(!0)};if(s||!n)return e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t});if(n.startsWith("data:"))try{const i=atob(n.split(",")[1]);return e.jsx("div",{className:"h-8 flex items-center",dangerouslySetInnerHTML:{__html:i},onError:a})}catch(i){return console.error("Error parsing logo data URL:",i),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:t})}return e.jsx("img",{src:n,alt:"Organization Logo",className:"h-8 w-auto",onError:a})},vi=()=>{const n=Xs(),{user:t,signOut:s}=Ft(),{userProfile:r,isAdmin:a}=W(),[i,o]=j.useState(null);j.useEffect(()=>{const m=localStorage.getItem("custom-logo");m&&o(m)},[]);const l=[{path:"/",label:"Dashboard",icon:yt},{path:"/documents",label:"Documents",icon:I},{path:"/upload",label:"Upload",icon:Dt},{path:"/operations",label:"Operations",icon:ms}];a&&(l.push({path:"/users",label:"Users",icon:ae}),l.push({path:"/oauth",label:"OAuth",icon:Ne}));const c=async()=>{try{await s()}catch(m){console.error("Error signing out:",m)}},d=m=>{o(m)},h=r?(m=>{switch(m){case"master_admin":return{text:"Master Admin",color:"bg-purple-100 text-purple-800"};case"admin":return{text:"Admin",color:"bg-blue-100 text-blue-800"};default:return{text:"User",color:"bg-gray-100 text-gray-800"}}})(r.role):null;return e.jsx("nav",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(yi,{logoUrl:i||""}),e.jsx(bi,{currentLogo:i||void 0,onLogoChange:d,isAdmin:a})]}),e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:"v2.1.0"})]}),e.jsx("div",{className:"flex space-x-4",children:l.map(({path:m,label:g,icon:v})=>e.jsxs(er,{to:m,className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${n.pathname===m?"bg-blue-100 text-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[e.jsx(v,{size:16}),e.jsx("span",{children:g})]},m))})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex items-center space-x-3 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{size:16}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900",children:(r==null?void 0:r.full_name)||(t==null?void 0:t.email)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:t==null?void 0:t.email}),h&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${h.color}`,children:h.text})]})]})]})}),e.jsxs("button",{onClick:c,className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[e.jsx(pr,{size:16}),e.jsx("span",{children:"Sign out"})]})]})]})})})},wi=({integration:n,color:t,onEditIntegration:s})=>{const{isMasterAdmin:r}=W(),{isConnected:a,launchService:i,initiateOAuth:o}=zt(),[l,c]=j.useState(!1),[d,u]=j.useState({name:"",title:"",email:"",phone:"",company:"",notes:""}),h=n.name.toLowerCase().replace(/\s+/g,"-"),m=n.supportsOAuth!==!1&&ui.supportsOAuth(h),g=a(h);j.useEffect(()=>{const f=localStorage.getItem(`integration-contact-${n.name.toLowerCase().replace(/\s+/g,"-")}`);f&&u(JSON.parse(f))},[n.name]);const v=()=>{localStorage.setItem(`integration-contact-${n.name.toLowerCase().replace(/\s+/g,"-")}`,JSON.stringify(d)),c(!1)},b=()=>{const f=localStorage.getItem(`integration-contact-${n.name.toLowerCase().replace(/\s+/g,"-")}`);f&&u(JSON.parse(f)),c(!1)},x=()=>{m?i(h,n.url):window.open(n.url,"_blank")},p=()=>{m&&o(h)},w=d.name||d.email||d.phone;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n.name}),e.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full bg-${t}-100 text-${t}-800`,children:n.category}),m?e.jsx("span",{className:`inline-flex items-center px-2 py-1 text-xs rounded-full ${g?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"OAuth Connected"]}):e.jsxs(e.Fragment,{children:[e.jsx(vt,{className:"h-3 w-3 mr-1"}),"OAuth Available"]})}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:[e.jsx(We,{className:"h-3 w-3 mr-1"}),"Manual Access"]}),r&&s&&e.jsx("button",{onClick:()=>s(n),className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Edit Integration",children:e.jsx(H,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:n.description}),n.note&&e.jsxs("p",{className:"text-xs text-blue-600 bg-blue-50 p-2 rounded mb-3",children:[" ",n.note]})]}),e.jsx(xt,{className:"h-5 w-5 text-gray-400 flex-shrink-0"})]}),m&&e.jsxs("div",{className:`mb-4 p-3 rounded-lg ${g?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[g?e.jsx(re,{className:"h-4 w-4 text-green-600"}):e.jsx(vt,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:`text-sm font-medium ${g?"text-green-800":"text-yellow-800"}`,children:g?"OAuth Connected":"OAuth Available"})]}),!g&&e.jsx("button",{onClick:p,className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Connect"})]}),e.jsx("p",{className:`text-xs mt-1 ${g?"text-green-700":"text-yellow-700"}`,children:g?"Seamless access enabled - no manual login required":"Connect for seamless access without manual login"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Primary Contact"}),e.jsx("button",{onClick:()=>c(!l),className:`p-1.5 rounded-md transition-colors ${l?"text-gray-600 hover:text-gray-800 hover:bg-gray-100":`text-${t}-600 hover:text-${t}-700 hover:bg-${t}-50`}`,title:l?"Cancel":"Edit Contact",children:l?e.jsx(J,{className:"h-3 w-3"}):e.jsx(fs,{className:"h-3 w-3"})})]}),l?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx($e,{className:"inline h-3 w-3 mr-1"}),"Contact Name"]}),e.jsx("input",{type:"text",value:d.name,onChange:f=>u(y=>({...y,name:f.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Contact name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Job Title"}),e.jsx("input",{type:"text",value:d.title,onChange:f=>u(y=>({...y,title:f.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Account Manager, Support Rep, etc."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx(Q,{className:"inline h-3 w-3 mr-1"}),"Email"]}),e.jsx("input",{type:"email",value:d.email,onChange:f=>u(y=>({...y,email:f.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"contact@company.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx(Vt,{className:"inline h-3 w-3 mr-1"}),"Phone"]}),e.jsx("input",{type:"tel",value:d.phone,onChange:f=>u(y=>({...y,phone:f.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.jsx(Ue,{className:"inline h-3 w-3 mr-1"}),"Department/Team"]}),e.jsx("input",{type:"text",value:d.company,onChange:f=>u(y=>({...y,company:f.target.value})),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Customer Success, Sales, Support"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:d.notes,onChange:f=>u(y=>({...y,notes:f.target.value})),rows:2,className:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 focus:border-transparent",placeholder:"Account details, preferences, etc."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx("button",{onClick:b,className:"px-2 py-1 text-xs border border-gray-300 rounded text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:v,className:`flex items-center space-x-1 px-2 py-1 text-xs bg-${t}-600 text-white rounded hover:bg-${t}-700 transition-colors`,children:[e.jsx(Me,{className:"h-3 w-3"}),e.jsx("span",{children:"Save"})]})]})]}):e.jsx("div",{className:"space-y-2",children:w?e.jsxs(e.Fragment,{children:[d.name&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900 truncate",children:d.name}),d.title&&e.jsx("p",{className:"text-xs text-gray-600 truncate",children:d.title})]})]}),d.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsx("a",{href:`mailto:${d.email}`,className:`text-xs text-${t}-600 hover:text-${t}-700 hover:underline truncate`,children:d.email})]}),d.phone&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Vt,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsx("a",{href:`tel:${d.phone}`,className:`text-xs text-${t}-600 hover:text-${t}-700 hover:underline`,children:d.phone})]}),d.company&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-3 w-3 text-gray-400 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-gray-700 truncate",children:d.company})]}),d.notes&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:d.notes})})]}):e.jsxs("div",{className:"text-center py-3",children:[e.jsx($e,{className:"h-6 w-6 text-gray-300 mx-auto mb-1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"No contact assigned"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Click edit to add contact"})]})})]}),e.jsxs("div",{className:"flex space-x-2 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("button",{onClick:x,className:`flex-1 bg-${t}-600 text-white px-3 py-2 rounded text-xs font-medium hover:bg-${t}-700 transition-colors text-center flex items-center justify-center space-x-1`,children:[m&&g&&e.jsx(re,{className:"h-3 w-3"}),e.jsx("span",{children:m&&g?"Launch (OAuth)":"Open Platform"})]}),e.jsx("button",{className:"px-3 py-2 border border-gray-300 rounded text-xs font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Configure"})]})]})},ji=({isOpen:n,onClose:t,integration:s,onSave:r})=>{const[a,i]=j.useState({name:"",description:"",url:"",category:""}),o=["HRIS","Payroll","Benefits","Safety","Insurance","Accounting","Invoicing","Free","Legal Services","E-Signature","Practice Management","Contract Management","Compliance","Design","Professional","UI/UX","Monitoring","Management","Scheduling","Enterprise","Visual","Internal","Email Marketing","Video","Volunteer","Opportunities","Streaming","Podcast","Custom"];Se.useEffect(()=>{s&&i(s)},[s]);const l=d=>{d.preventDefault(),r(a),t()},c=()=>{s&&i(s),t()};return!n||!s?null:e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:c}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Integration"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Customize integration details for your organization"})]}),e.jsx("button",{onClick:c,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:l,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ht,{className:"inline h-4 w-4 mr-1"}),"Service Name"]}),e.jsx("input",{type:"text",value:a.name,onChange:d=>i(u=>({...u,name:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Service name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(I,{className:"inline h-4 w-4 mr-1"}),"Description"]}),e.jsx("textarea",{value:a.description,onChange:d=>i(u=>({...u,description:d.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe how this service helps your organization...",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Customize this description to reflect how your organization uses this service"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ht,{className:"inline h-4 w-4 mr-1"}),"Service URL"]}),e.jsx("input",{type:"url",value:a.url,onChange:d=>i(u=>({...u,url:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://example.com",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Link to your organization's login page or dashboard for this service"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Qe,{className:"inline h-4 w-4 mr-1"}),"Business Category"]}),e.jsxs("select",{value:a.category,onChange:d=>i(u=>({...u,category:d.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),o.map(d=>e.jsx("option",{value:d,children:d},d))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the category that best describes this service's role in your business"})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(H,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Customization Tips"}),e.jsxs("ul",{className:"mt-1 text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:" Update the description to reflect your specific use case"}),e.jsx("li",{children:" Use your organization's direct login URL if available"}),e.jsx("li",{children:" Choose categories that match your business structure"}),e.jsx("li",{children:" Consider creating custom categories for unique services"})]})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Changes"})]})]})]})]})})]})},_i=()=>{const n=()=>"Acme Nonprofit Foundation",[t,s]=j.useState({entityName:n(),entityType:"Non-Profit Corporation",status:"Unknown",filingDate:"",nextDueDate:"",annualReportStatus:"Unknown",lastUpdated:""}),[r,a]=j.useState(!1),[i,o]=j.useState(t);j.useEffect(()=>{const v=localStorage.getItem("demo-corporate-status");if(v){const b=JSON.parse(v);s(b),o(b)}else{const b={...t,entityName:n()};s(b),o(b)}},[]);const c=(()=>{if(!t.nextDueDate)return"unknown";const g=new Date(t.nextDueDate),v=new Date,b=ft(v,30);return we(g,v)?"overdue":we(g,b)?"due-soon":"current"})(),d=()=>{const g={...i,lastUpdated:new Date().toISOString()};s(g),localStorage.setItem("demo-corporate-status",JSON.stringify(g)),a(!1)},u=()=>{o(t),a(!1)},h=g=>{switch(g){case"Active":case"Current":return"text-green-800 bg-green-100";case"Due Soon":return"text-yellow-800 bg-yellow-100";case"Overdue":case"Suspended":return"text-red-800 bg-red-100";case"Inactive":return"text-gray-800 bg-gray-100";default:return"text-blue-800 bg-blue-100"}},m=()=>{switch(c){case"current":return e.jsx(re,{className:"h-5 w-5 text-green-600"});case"due-soon":return e.jsx(Xe,{className:"h-5 w-5 text-yellow-600"});case"overdue":return e.jsx(We,{className:"h-5 w-5 text-red-600"});default:return e.jsx(Ue,{className:"h-5 w-5 text-blue-600"})}};return e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[m(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Corporate Status Dashboard"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Demo Corporate Filing Status"})]})]}),e.jsx("button",{onClick:()=>a(!r),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:r?"Cancel":"Edit Status",children:r?e.jsx(J,{className:"h-4 w-4"}):e.jsx(fs,{className:"h-4 w-4"})})]})}),e.jsx("div",{className:"p-6",children:r?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Name"}),e.jsx("input",{type:"text",value:i.entityName,onChange:g=>o(v=>({...v,entityName:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Type"}),e.jsxs("select",{value:i.entityType,onChange:g=>o(v=>({...v,entityType:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"Non-Profit Corporation",children:"Non-Profit Corporation"}),e.jsx("option",{value:"Corporation",children:"Corporation"}),e.jsx("option",{value:"LLC",children:"LLC"}),e.jsx("option",{value:"Partnership",children:"Partnership"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Status"}),e.jsxs("select",{value:i.status,onChange:g=>o(v=>({...v,status:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Suspended",children:"Suspended"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Filing Date"}),e.jsx("input",{type:"date",value:i.filingDate,onChange:g=>o(v=>({...v,filingDate:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Next Due Date"}),e.jsx("input",{type:"date",value:i.nextDueDate,onChange:g=>o(v=>({...v,nextDueDate:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Report Status"}),e.jsxs("select",{value:i.annualReportStatus,onChange:g=>o(v=>({...v,annualReportStatus:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"Current",children:"Current"}),e.jsx("option",{value:"Due Soon",children:"Due Soon"}),e.jsx("option",{value:"Overdue",children:"Overdue"}),e.jsx("option",{value:"Unknown",children:"Unknown"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:d,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 transition-colors",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Status"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[c!=="current"&&c!=="unknown"&&e.jsx("div",{className:`p-4 rounded-lg border ${c==="overdue"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(We,{className:`h-5 w-5 ${c==="overdue"?"text-red-600":"text-yellow-600"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${c==="overdue"?"text-red-800":"text-yellow-800"}`,children:c==="overdue"?"Filing Overdue!":"Filing Due Soon"}),e.jsx("p",{className:`text-sm ${c==="overdue"?"text-red-700":"text-yellow-700"}`,children:t.nextDueDate&&`Next filing due: ${D(new Date(t.nextDueDate),"MMMM dd, yyyy")}`})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Entity Name"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.entityName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Entity Type"}),e.jsx("p",{className:"text-gray-900",children:t.entityType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Current Status"}),e.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${h(t.status)}`,children:t.status})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Last Filing Date"}),e.jsx("p",{className:"text-gray-900",children:t.filingDate?D(new Date(t.filingDate),"MMMM dd, yyyy"):"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Next Due Date"}),e.jsx("p",{className:"text-gray-900",children:t.nextDueDate?D(new Date(t.nextDueDate),"MMMM dd, yyyy"):"Not set"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Annual Report Status"}),e.jsx("span",{className:`inline-block px-3 py-1 text-sm font-medium rounded-full ${h(t.annualReportStatus)}`,children:t.annualReportStatus})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 w-full",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Demo Mode"}),e.jsx("p",{className:"text-sm text-blue-800",children:"In production, this would link to your state's corporate filing system for real status updates."})]})]})})})}),t.lastUpdated&&e.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-100",children:["Last updated: ",D(new Date(t.lastUpdated),"MMM dd, yyyy HH:mm")]})]})})]})},Ni=({isOpen:n,onClose:t,documents:s,categoryColor:r})=>{const[a,i]=j.useState({to:"",cc:"",bcc:"",subject:"",message:"",includeLinks:!0,includeAttachments:!1}),[o,l]=j.useState(!1);Se.useEffect(()=>{if(s.length>0){const m=s.length===1?`Document: ${s[0].name}`:`${s.length} Documents from ${s[0].category}`;i(g=>({...g,subject:m,message:c()}))}},[s]);const c=()=>{if(s.length===0)return"";if(s.length===1){const m=s[0];return`Hi,

I'm sharing the following document with you:

Document: ${m.name}
Category: ${m.category}
${m.description?`Description: ${m.description}`:""}
Upload Date: ${D(new Date(m.created_at),"MMMM dd, yyyy")}
${m.expiry_date?`Expires: ${D(new Date(m.expiry_date),"MMMM dd, yyyy")}`:""}

${a.includeLinks?"You can view this document using the link provided above.":"The document is attached to this email."}

Best regards`}else return`Hi,

I'm sharing ${s.length} documents with you from our ${s[0].category} collection:

${s.map(m=>` ${m.name}`).join(`
`)}

${a.includeLinks?"You can view these documents using the links provided above.":"The documents are attached to this email."}

Best regards`},d=async()=>{if(!a.to.trim()){alert("Please enter at least one recipient email address.");return}l(!0);try{await new Promise(m=>setTimeout(m,2e3)),alert(`Email sent successfully to ${a.to}!`),t(),i({to:"",cc:"",bcc:"",subject:"",message:"",includeLinks:!0,includeAttachments:!1})}catch{alert("Failed to send email. Please try again.")}finally{l(!1)}},u=m=>{if(m===0)return"0 Bytes";const g=1024,v=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(m)/Math.log(g));return parseFloat((m/Math.pow(g,b)).toFixed(2))+" "+v[b]},h=s.reduce((m,g)=>m+g.size,0);return n?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-${r}-100`,children:e.jsx(Q,{className:`h-5 w-5 text-${r}-600`})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Email Documents"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.length," document",s.length!==1?"s":""," selected"]})]})]}),e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx($e,{className:"inline h-4 w-4 mr-1"}),"To *"]}),e.jsx("input",{type:"email",value:a.to,onChange:m=>i(g=>({...g,to:m.target.value})),placeholder:"recipient@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:o}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separate multiple email addresses with commas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CC"}),e.jsx("input",{type:"email",value:a.cc,onChange:m=>i(g=>({...g,cc:m.target.value})),placeholder:"cc@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"BCC"}),e.jsx("input",{type:"email",value:a.bcc,onChange:m=>i(g=>({...g,bcc:m.target.value})),placeholder:"bcc@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),e.jsx("input",{type:"text",value:a.subject,onChange:m=>i(g=>({...g,subject:m.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:a.message,onChange:m=>i(g=>({...g,message:m.target.value})),rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your message here...",disabled:o})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"includeLinks",checked:a.includeLinks,onChange:m=>i(g=>({...g,includeLinks:m.target.checked})),className:`rounded text-${r}-600 focus:ring-${r}-500`,disabled:o}),e.jsx("label",{htmlFor:"includeLinks",className:"text-sm text-gray-700",children:"Include download links in email"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"includeAttachments",checked:a.includeAttachments,onChange:m=>i(g=>({...g,includeAttachments:m.target.checked})),className:`rounded text-${r}-600 focus:ring-${r}-500`,disabled:o}),e.jsx("label",{htmlFor:"includeAttachments",className:"text-sm text-gray-700",children:"Attach files to email"})]}),a.includeAttachments&&h>25*1024*1024&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[" Total file size (",u(h),") exceeds typical email limits (25MB). Consider using download links instead."]})})]})]})}),e.jsxs("div",{className:"w-80 border-l border-gray-200 p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(xr,{className:"h-4 w-4 text-gray-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Documents to Email"})]}),e.jsx("div",{className:"space-y-3",children:s.map(m=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(I,{className:"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m.name}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full bg-${r}-100 text-${r}-800`,children:m.category}),e.jsx("span",{className:"text-xs text-gray-500",children:u(m.size)})]}),m.description&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:m.description})]})]})},m.id))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:["Total: ",s.length," document",s.length!==1?"s":""]}),e.jsxs("p",{children:["Size: ",u(h)]})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 flex-shrink-0",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:o,children:"Cancel"}),e.jsxs("button",{onClick:d,disabled:o||!a.to.trim()||!a.subject.trim(),className:`flex items-center space-x-2 px-4 py-2 bg-${r}-600 text-white rounded-lg hover:bg-${r}-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors`,children:[e.jsx(br,{className:"h-4 w-4"}),e.jsx("span",{children:o?"Sending...":"Send Email"})]})]})]})})]}):null},Ws=({category:n,categoryTitle:t,color:s})=>{const{documents:r,loading:a,downloadDocument:i}=ie(),[o,l]=j.useState(""),[c,d]=j.useState(null),[u,h]=j.useState(!1),[m,g]=j.useState(!1),[v,b]=j.useState([]),[x,p]=j.useState(new Set),w=r.filter(N=>{var oe;const $=N.category.toLowerCase().includes(n.toLowerCase())||N.tags.some(Ee=>Ee.toLowerCase().includes(n.toLowerCase())),X=N.name.toLowerCase().includes(o.toLowerCase())||((oe=N.description)==null?void 0:oe.toLowerCase().includes(o.toLowerCase()))||N.tags.some(Ee=>Ee.toLowerCase().includes(o.toLowerCase()));return $&&(o===""||X)}),f=N=>{d(N),h(!0)},y=async(N,$)=>{try{await i(N,$)}catch(X){alert("Failed to download document: "+(X instanceof Error?X.message:"Unknown error"))}},k=N=>{b([N]),g(!0)},A=()=>{const N=w.filter($=>x.has($.id));b(N),g(!0)},O=N=>{const $=new Set(x);$.has(N)?$.delete(N):$.add(N),p($)},F=()=>{x.size===w.length?p(new Set):p(new Set(w.map(N=>N.id)))},K=N=>{if(N===0)return"0 Bytes";const $=1024,X=["Bytes","KB","MB","GB"],oe=Math.floor(Math.log(N)/Math.log($));return parseFloat((N/Math.pow($,oe)).toFixed(2))+" "+X[oe]};return a?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((N,$)=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},$))})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-${s}-100`,children:e.jsx(I,{className:`h-5 w-5 text-${s}-600`})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[t," Documents"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[w.length," document",w.length!==1?"s":""," found"]})]})]}),x.size>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[x.size," selected"]}),e.jsxs("button",{onClick:A,className:`flex items-center space-x-1 px-3 py-1 bg-${s}-600 text-white rounded-md text-sm hover:bg-${s}-700 transition-colors`,children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{children:"Email Selected"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search documents...",value:o,onChange:N=>l(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),w.length>0&&e.jsxs("button",{onClick:F,className:"flex items-center space-x-1 px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:x.size===w.length,onChange:()=>{},className:"rounded"}),e.jsx("span",{children:"Select All"})]})]})]}),e.jsx("div",{className:"p-6",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsxs("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:["No ",t," Documents Found"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:o?`No documents match "${o}" in the ${t} category.`:`No documents have been uploaded for the ${t} category yet.`}),e.jsx("button",{onClick:()=>window.location.href="/upload",className:`px-4 py-2 bg-${s}-600 text-white rounded-lg hover:bg-${s}-700 transition-colors`,children:"Upload Documents"})]}):e.jsx("div",{className:"space-y-3",children:w.map(N=>e.jsx("div",{className:`border rounded-lg p-4 hover:shadow-md transition-shadow ${x.has(N.id)?`border-${s}-300 bg-${s}-50`:"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:x.has(N.id),onChange:()=>O(N.id),className:`mt-1 rounded text-${s}-600 focus:ring-${s}-500`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:N.name}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full bg-${s}-100 text-${s}-800`,children:N.category}),N.expiry_date&&e.jsxs("span",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[e.jsx(Xe,{className:"h-3 w-3"}),e.jsxs("span",{children:["Expires ",D(new Date(N.expiry_date),"MMM dd, yyyy")]})]})]}),N.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:N.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsx("span",{children:K(N.size)}),e.jsxs("span",{children:["Uploaded ",D(new Date(N.created_at),"MMM dd, yyyy")]}),N.tags.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),e.jsx("span",{children:N.tags.slice(0,2).join(", ")}),N.tags.length>2&&e.jsxs("span",{children:["+",N.tags.length-2]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>f(N),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View Document",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>y(N.file_path,N.name),className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Download Document",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>k(N),className:`p-2 text-gray-400 hover:text-${s}-600 hover:bg-${s}-50 rounded-lg transition-colors`,title:"Email Document",children:e.jsx(Q,{className:"h-4 w-4"})})]})]})},N.id))})})]}),e.jsx(Js,{isOpen:u,onClose:()=>{h(!1),d(null)},document:c,onDownload:y}),e.jsx(Ni,{isOpen:m,onClose:()=>{g(!1),b([])},documents:v,categoryColor:s})]})},ki=()=>{const{category:n}=Ze(),t=me(),{documents:s}=ie(),{isMasterAdmin:r}=W(),[a,i]=j.useState(!1),[o,l]=j.useState(null),[c,d]=j.useState([]),u={hr:{title:"Human Resources",description:"Manage your team, payroll, and HR processes",color:"blue",integrations:[{name:"HR Ministry Solutions",description:"Complete HR management platform for ministries with API integration capabilities",url:"https://online.hrministrysolutions.com/hc/en-us",category:"HRIS",supportsOAuth:!1,note:"Contact provider for API access and integration options"},{name:"Ministry Safe",description:"Background screening and safety solutions with limited API access",url:"https://safetysystem.ministrysafe.com/auth/sign_in",category:"Safety",supportsOAuth:!1,note:"API access available for enterprise customers"},{name:"Gusto",description:"Payroll, benefits, and HR with OAuth 2.0 API integration",url:"https://gusto.com",category:"Payroll",supportsOAuth:!0,note:"Full OAuth 2.0 support with comprehensive API"},{name:"GuideStone",description:"Retirement and benefits administration for ministry workers",url:"https://login.guidestone.org/",category:"Benefits",supportsOAuth:!1,note:"Specialized retirement and insurance benefits for ministry professionals"},{name:"The Standard",description:"Group insurance and employee benefits platform",url:"https://login.standard.com/",category:"Insurance",supportsOAuth:!1,note:"Comprehensive group insurance and disability coverage"}]},accounting:{title:"Accounting & Finance",description:"Manage your finances, invoicing, and accounting",color:"green",integrations:[{name:"QuickBooks Online",description:"Complete accounting software with OAuth integration",url:"https://quickbooks.intuit.com",category:"Accounting"},{name:"Bill.com",description:"Accounts payable and receivable automation platform",url:"https://www.bill.com",category:"Accounting",supportsOAuth:!1,note:"API access available for business plans"},{name:"Pushpay",description:"Digital giving and donor management platform for churches",url:"https://pushpay.com",category:"Donations",supportsOAuth:!1,note:"Specialized giving platform with church management features"},{name:"Live Your Parable",description:"Financial planning and stewardship education platform",url:"https://liveyourparable.com/",category:"Financial Planning",supportsOAuth:!1,note:"Faith-based financial education and planning tools"},{name:"National Bank of Arizona",description:"Personal and business banking services",url:"https://www.nbarizona.com/personal/",category:"Banking",supportsOAuth:!1,note:"Local banking partner with business account management"}]},communications:{title:"Communications",description:"Manage internal and external communications",color:"indigo",integrations:[{name:"Slack",description:"Team communication with OAuth integration",url:"https://slack.com",category:"Internal"},{name:"Mailchimp",description:"Email marketing with OAuth integration",url:"https://mailchimp.com",category:"Email Marketing"},{name:"Zoom",description:"Video conferencing and webinars",url:"https://zoom.us",category:"Video"}]},legal:{title:"Legal Affairs & Compliance",description:"Manage legal documents, contracts, and compliance",color:"gray",integrations:[{name:"DocuSign",description:"Electronic signature and document management",url:"https://www.docusign.com",category:"E-Signature"},{name:"E-Verify",description:"Employment eligibility verification system",url:"https://www.e-verify.gov",category:"Compliance",supportsOAuth:!1,note:"Government system for verifying employee work authorization"},{name:"Arizona Corporate Commission",description:"State corporate filing and compliance portal",url:"https://ecorp.azcc.gov/",category:"Corporate Compliance",supportsOAuth:!1,note:"Official state portal for corporate filings, annual reports, and entity searches"}]},branding:{title:"Branding & Design",description:"Create and manage your brand identity",color:"purple",integrations:[{name:"Canva",description:"Design platform for creating visual content",url:"https://www.canva.com",category:"Design"}]},"social-media":{title:"Social Media Management",description:"Manage your social media presence and engagement",color:"pink",integrations:[{name:"Instagram",description:"Photo and video sharing platform for visual storytelling",url:"https://www.instagram.com",category:"Social Platform",supportsOAuth:!1,note:"Direct access to Instagram for content creation and community engagement"},{name:"Facebook",description:"Social networking platform for community building and events",url:"https://www.facebook.com",category:"Social Platform",supportsOAuth:!1,note:"Connect with your community through posts, events, and messaging"},{name:"Meta for Business",description:"Business tools for Facebook and Instagram advertising and analytics",url:"https://business.facebook.com",category:"Business Tools",supportsOAuth:!1,note:"Manage ads, analyze performance, and grow your social media presence"},{name:"Linktree",description:"Link-in-bio tool to share multiple links from social media profiles",url:"https://linktr.ee",category:"Link Management",supportsOAuth:!1,note:"Create a custom landing page to share multiple important links"}]},"volunteer-management":{title:"Volunteer & People Management",description:"Coordinate and manage volunteers and team members",color:"orange",integrations:[{name:"Planning Center",description:"Church management software for planning and volunteer coordination",url:"https://login.planningcenteronline.com/",category:"Church Management",supportsOAuth:!1,note:"Comprehensive church management with volunteer scheduling and event planning"},{name:"ChMS (Church Community Builder)",description:"Complete church management system for member and volunteer coordination",url:"https://redemptionflagstaff.ccbchurch.com/",category:"Church Management",supportsOAuth:!1,note:"Full-featured church management with member database and volunteer tracking"},{name:"Wufoo",description:"Online form builder for volunteer registration and event sign-ups",url:"https://secure.wufoo.com/login/",category:"Forms & Registration",supportsOAuth:!1,note:"Easy-to-use form builder for collecting volunteer information and event registrations"}]},streaming:{title:"Streaming: Video & Podcast",description:"Create, manage, and distribute video and audio content",color:"red",integrations:[{name:"YouTube",description:"Video hosting and management platform with OAuth integration",url:"https://www.youtube.com",category:"Video Platform",supportsOAuth:!0,note:"Full OAuth support for channel management, video uploads, and analytics"},{name:"Transistor.fm",description:"Professional podcast hosting and analytics platform",url:"https://transistor.fm",category:"Podcast Hosting",supportsOAuth:!1,note:"Comprehensive podcast hosting with detailed analytics and distribution"}]},it:{title:"IT & Technology",description:"Technology infrastructure and digital tools management",color:"cyan",integrations:[{name:"Google Workspace",description:"Access Gmail, Drive, Calendar, and other Google services with OAuth",url:"https://workspace.google.com",category:"Productivity"},{name:"Google Search Console",description:"Monitor and optimize your website's search performance with OAuth",url:"https://search.google.com/search-console",category:"Analytics"},{name:"Squarespace",description:"Website builder and hosting platform for creating professional websites",url:"https://www.squarespace.com",category:"Website Management",supportsOAuth:!1,note:"All-in-one platform for building, hosting, and managing your organization's website"}]}};j.useEffect(()=>{const y=localStorage.getItem(`custom-integrations-${n}`);y&&d(JSON.parse(y))},[n]);const h=()=>{const y=u[n];return y?y.integrations.map(k=>{const A=localStorage.getItem(`integration-customization-${k.name.toLowerCase().replace(/\s+/g,"-")}`);return A?{...k,...JSON.parse(A)}:k}):[]},m=u[n];if(!m)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Category Not Found"}),e.jsx("button",{onClick:()=>t("/"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return to Dashboard"})]});const g=s.filter(y=>y.category.toLowerCase().includes((n==null?void 0:n.toLowerCase())||"")||y.tags.some(k=>k.toLowerCase().includes((n==null?void 0:n.toLowerCase())||""))),b=[...h(),...c],x=y=>{l(y),i(!0)},p=y=>{if(m.integrations.some(A=>A.name===y.name))localStorage.setItem(`integration-customization-${y.name.toLowerCase().replace(/\s+/g,"-")}`,JSON.stringify(y));else{const A=c.map(O=>O.name===(o==null?void 0:o.name)?y:O);d(A),localStorage.setItem(`custom-integrations-${n}`,JSON.stringify(A))}},w=()=>{l({name:"New Integration",description:"Custom integration for your organization",url:"https://example.com",category:"Custom"}),i(!0)},f=y=>{const k=[...c,y];d(k),localStorage.setItem(`custom-integrations-${n}`,JSON.stringify(k))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx($t,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:m.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:m.description})]})]}),r&&e.jsxs("button",{onClick:w,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ps,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Integration"})]})]}),n==="legal"&&e.jsx(_i,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${m.color}-500 p-3 rounded-lg`,children:e.jsx(I,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Related Documents"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${m.color}-500 p-3 rounded-lg`,children:e.jsx(H,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Available Tools"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${m.color}-500 p-3 rounded-lg`,children:e.jsx(yt,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"OAuth Ready"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.filter(y=>["Google Workspace","Google Search Console","QuickBooks Online","Slack","Mailchimp","Gusto","YouTube"].includes(y.name)).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${m.color}-500 p-3 rounded-lg`,children:e.jsx(I,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Contacts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b.filter(y=>{const k=localStorage.getItem(`integration-contact-${y.name.toLowerCase().replace(/\s+/g,"-")}`);return k&&JSON.parse(k).name}).length})]})]})})]}),e.jsx(Ws,{category:n||"",categoryTitle:m.title,color:m.color}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Integration Tools & OAuth Connections"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Secure OAuth integration available for supported services"})]}),r&&e.jsxs("div",{className:"text-sm text-blue-600",children:[e.jsx(H,{className:"inline h-4 w-4 mr-1"}),"Master Admin: Click settings icon on cards to customize"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map((y,k)=>e.jsx(wi,{integration:y,color:m.color,onEditIntegration:r?x:void 0},`${y.name}-${k}`))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>t("/upload"),className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[e.jsx(I,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Upload Documents"})]}),e.jsxs("button",{onClick:()=>t("/oauth"),className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[e.jsx(H,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Manage OAuth"})]}),e.jsxs("button",{onClick:()=>t("/documents"),className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[e.jsx(yt,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"View Reports"})]})]})]}),e.jsx(ji,{isOpen:a,onClose:()=>{i(!1),l(null)},integration:o,onSave:y=>{(c.some(k=>k.name===(o==null?void 0:o.name))||(o==null?void 0:o.name)==="New Integration")&&(o==null?void 0:o.name)==="New Integration"?f(y):p(y)}})]})},Si=()=>{const n=me(),{documents:t}=ie(),{isAdmin:s}=W(),r=[{id:"hr",name:"HR",description:"Human Resources Management",icon:Jt,color:"bg-blue-600 hover:bg-blue-700",textColor:"text-blue-600",bgColor:"bg-blue-50",route:"/operations/hr"},{id:"accounting",name:"Accounting",description:"Financial Management & Bookkeeping",icon:yr,color:"bg-green-600 hover:bg-green-700",textColor:"text-green-600",bgColor:"bg-green-50",route:"/operations/accounting"},{id:"legal",name:"Legal",description:"Legal Affairs & Compliance",icon:vr,color:"bg-gray-600 hover:bg-gray-700",textColor:"text-gray-600",bgColor:"bg-gray-50",route:"/operations/legal"},{id:"branding",name:"Branding",description:"Brand Management & Design",icon:wr,color:"bg-purple-600 hover:bg-purple-700",textColor:"text-purple-600",bgColor:"bg-purple-50",route:"/operations/branding"},{id:"social-media",name:"Social Media",description:"Social Media Management",icon:jr,color:"bg-pink-600 hover:bg-pink-700",textColor:"text-pink-600",bgColor:"bg-pink-50",route:"/operations/social-media"},{id:"communications",name:"Communications",description:"Internal & External Communications",icon:Q,color:"bg-indigo-600 hover:bg-indigo-700",textColor:"text-indigo-600",bgColor:"bg-indigo-50",route:"/operations/communications"},{id:"volunteer-management",name:"Volunteer/People Management",description:"Volunteer Coordination & Management",icon:ae,color:"bg-orange-600 hover:bg-orange-700",textColor:"text-orange-600",bgColor:"bg-orange-50",route:"/operations/volunteer-management"},{id:"streaming",name:"Streaming: Video & Podcast",description:"Media Production & Broadcasting",icon:_r,color:"bg-red-600 hover:bg-red-700",textColor:"text-red-600",bgColor:"bg-red-50",route:"/operations/streaming"},{id:"it",name:"IT & Technology",description:"Technology Infrastructure & Digital Tools",icon:Nr,color:"bg-cyan-600 hover:bg-cyan-700",textColor:"text-cyan-600",bgColor:"bg-cyan-50",route:"/operations/it"}],a=o=>{n(o)},i=[{label:"Total Operations",value:r.length.toString(),description:"Available business operations"},{label:"Active Integrations",value:"12",description:"Connected services"},{label:"Documents",value:t.length.toString(),description:"Total documents managed"},{label:"Access Level",value:s?"Admin":"User",description:"Your permission level"}];return e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>n("/"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx($t,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Operations Center"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your organization's business operations and integrations"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:i.map(o=>e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-2",children:o.value}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:o.label}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o.description})]})},o.label))}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Business Operations"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Access your integrated business tools and administrative functions"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(o=>e.jsxs("button",{onClick:()=>a(o.route),className:"group relative overflow-hidden rounded-xl border border-gray-200 bg-white p-6 text-left transition-all duration-200 hover:border-gray-300 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx("div",{className:`inline-flex h-12 w-12 items-center justify-center rounded-lg ${o.bgColor} mb-4 group-hover:scale-110 transition-transform duration-200`,children:e.jsx(o.icon,{className:`h-6 w-6 ${o.textColor}`})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-gray-700",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600 group-hover:text-gray-500",children:o.description}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-gradient-to-r from-transparent via-gray-200 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]},o.id))})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"bg-blue-100 rounded-lg p-3",children:e.jsx(Jt,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Access Management"}),e.jsx("p",{className:"text-blue-800 mb-4",children:"Your access to operations is managed by your organization administrators. Contact your admin if you need access to additional operations areas."}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("span",{className:"text-blue-700",children:[e.jsx("strong",{children:"Current Role:"})," ",s?"Administrator":"User"]}),e.jsxs("span",{className:"text-blue-700",children:[e.jsx("strong",{children:"Access Level:"})," ",s?"Full Access":"Restricted Access"]})]})]})]})})]})},Ci=()=>{const{department:n}=Ze(),t=me(),{documents:s}=ie(),{isAdmin:r}=W(),i={"foster-adopt":{title:"Foster & Adopt",description:"Foster care and adoption services management",color:"pink",icon:"",features:["Family assessments and documentation","Adoption process tracking","Foster family management","Child placement coordination","Legal documentation","Training and certification records"]},"r-kids":{title:"R/Kids",description:"Children's ministry programs and activities",color:"blue",icon:"",features:["Children's program planning","Volunteer coordination","Safety and security protocols","Curriculum and materials","Parent communication","Event planning and execution"]},"r-youth":{title:"R/Youth",description:"Youth ministry and engagement programs",color:"green",icon:"",features:["Youth program development","Event planning and trips","Small group coordination","Volunteer leadership training","Parent and student communication","Discipleship tracking"]},"creative-media":{title:"Creative Media",description:"Media production and creative services",color:"purple",icon:"",features:["Video production planning","Graphic design projects","Photography coordination","Brand asset management","Equipment and resource tracking","Creative project workflows"]},cge:{title:"CGE",description:"Christian Growth & Education programs",color:"indigo",icon:"",features:["Educational program development","Curriculum planning","Teacher and leader resources","Student progress tracking","Class scheduling","Resource and material management"]},worship:{title:"Worship",description:"Worship ministry and music coordination",color:"orange",icon:"",features:["Service planning and coordination","Music team scheduling","Song and setlist management","Equipment and instrument tracking","Volunteer musician coordination","Special event worship planning"]},"sunday-production":{title:"Sunday Production",description:"Sunday service production and technical operations",color:"red",icon:"",features:["Service production planning","Technical equipment management","Volunteer tech team coordination","Audio/visual setup tracking","Live streaming coordination","Equipment maintenance schedules"]},"elder-board":{title:"Elder Board",description:"Elder board governance and decision making",color:"gray",icon:"",features:["Board meeting planning","Decision tracking and documentation","Policy development","Strategic planning","Governance oversight","Leadership development"]},"deacon-board":{title:"Deacon Board",description:"Deacon board service and support coordination",color:"cyan",icon:"",features:["Service project coordination","Community outreach planning","Member care and support","Facility and maintenance oversight","Volunteer coordination","Resource allocation"]}}[n];if(!i)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Department Not Found"}),e.jsx("button",{onClick:()=>t("/"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Return to Dashboard"})]});const o=s.filter(l=>l.category.toLowerCase().includes((n==null?void 0:n.toLowerCase())||"")||l.tags.some(c=>c.toLowerCase().includes((n==null?void 0:n.toLowerCase())||"")));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/"),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx($t,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:i.icon}),e.jsx("span",{children:i.title})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:i.description})]})]}),r&&e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:"Manage Access"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${i.color}-500 p-3 rounded-lg`,children:e.jsx(I,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Documents"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${i.color}-500 p-3 rounded-lg`,children:e.jsx(ae,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Team Members"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"8"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${i.color}-500 p-3 rounded-lg`,children:e.jsx(H,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Projects"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"5"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`bg-${i.color}-500 p-3 rounded-lg`,children:e.jsx(ps,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Resources"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"12"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Department Features & Capabilities"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.features.map((l,c)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 bg-${i.color}-500 rounded-full`}),e.jsx("span",{className:"text-sm text-gray-700",children:l})]},c))})]}),e.jsx(Ws,{category:n||"",categoryTitle:i.title,color:i.color}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>t("/upload"),className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[e.jsx(I,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Upload Documents"})]}),e.jsxs("button",{className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[e.jsx(ae,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Manage Team"})]}),e.jsxs("button",{className:"flex items-center justify-center space-x-2 p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-gray-400 hover:bg-gray-50 transition-colors",children:[e.jsx(H,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Department Settings"})]})]})]})]})},Ai=({isOpen:n,onClose:t})=>{const{inviteUser:s,organization:r}=W(),[a,i]=j.useState(!1),[o,l]=j.useState(null),[c,d]=j.useState(!1),[u,h]=j.useState({email:"",role:"user",full_name:""}),m=async b=>{b.preventDefault(),i(!0);try{const x=await s(u);l(x),h({email:"",role:"user",full_name:""})}catch(x){alert("Failed to send invitation: "+(x instanceof Error?x.message:"Unknown error"))}finally{i(!1)}},g=()=>{l(null),h({email:"",role:"user",full_name:""}),d(!1),t()},v=async()=>{if(!o)return;const b=`${window.location.origin}/invite/${o.token}`;try{await navigator.clipboard.writeText(b),d(!0),setTimeout(()=>d(!1),2e3)}catch{const p=document.createElement("textarea");p.value=b,document.body.appendChild(p),p.select(),document.execCommand("copy"),document.body.removeChild(p),d(!0),setTimeout(()=>d(!1),2e3)}};return n?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:g}),e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o?"Invitation Sent":"Invite User"}),e.jsx("button",{onClick:g,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(J,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6",children:o?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-6 mx-auto w-24 h-24 flex items-center justify-center",children:e.jsx(bt,{className:"h-12 w-12 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Invitation sent successfully!"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["An invitation has been sent to ",e.jsx("strong",{children:o.email})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Share this invitation link:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:`${window.location.origin}/invite/${o.token}`,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm bg-white"}),e.jsx("button",{onClick:v,className:`px-3 py-2 rounded-md text-sm font-medium transition-colors ${c?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,children:c?e.jsx(bt,{className:"h-4 w-4"}):e.jsx(kr,{className:"h-4 w-4"})})]})]}),e.jsx("button",{onClick:g,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Done"})]}):e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Q,{className:"inline h-4 w-4 mr-1"}),"Email Address"]}),e.jsx("input",{type:"email",value:u.email,onChange:b=>h(x=>({...x,email:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"user@example.com",required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name (Optional)"}),e.jsx("input",{type:"text",value:u.full_name,onChange:b=>h(x=>({...x,full_name:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs("select",{value:u.role,onChange:b=>h(x=>({...x,role:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Users can view and manage documents. Admins can also invite and manage other users."})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Organization:"})," ",r==null?void 0:r.name]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"The invited user will be added to this organization."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:a,children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{children:a?"Sending...":"Send Invitation"})]})]})]})})]})})]}):null},Ei=()=>{const{createOrganization:n}=W(),[t,s]=j.useState(""),[r,a]=j.useState(!1),i=async o=>{if(o.preventDefault(),!!t.trim()){a(!0);try{await n(t.trim())}catch(l){alert("Failed to create organization: "+(l instanceof Error?l.message:"Unknown error"))}finally{a(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-blue-100",children:e.jsx(Ue,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Set up your organization"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Create your organization to start managing users and documents"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:i,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"organization-name",className:"block text-sm font-medium text-gray-700",children:"Organization Name"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"organization-name",name:"organization-name",type:"text",required:!0,value:t,onChange:o=>s(o.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your organization name",disabled:r})})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ae,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"What happens next?"}),e.jsxs("ul",{className:"mt-2 text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:" You'll become the master administrator"}),e.jsx("li",{children:" You can invite team members to join"}),e.jsx("li",{children:" Manage user roles and permissions"}),e.jsx("li",{children:" Control access to documents and features"})]})]})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:r||!t.trim(),className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:r?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating organization..."]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{children:"Create Organization"}),e.jsx(Sr,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})})]})]})})},Oi=()=>{const{userProfile:n,organization:t,users:s,invitations:r,loading:a,error:i,isAdmin:o,isMasterAdmin:l,updateUserRole:c,deactivateUser:d,reactivateUser:u,cancelInvitation:h}=W(),[m,g]=j.useState(!1);if(a)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your organization's users and permissions"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((f,y)=>e.jsx("div",{className:"h-4 bg-gray-200 rounded"},y))})]})})]});if(i)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your organization's users and permissions"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("div",{className:"text-center py-8",children:e.jsxs("p",{className:"text-red-600 mb-4",children:["Error: ",i]})})})]});if(!t)return e.jsx(Ei,{});if(!o)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your organization's users and permissions"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ne,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-gray-600",children:"You need admin privileges to access user management."})]})})]});const v=async(f,y)=>{try{await c(f,y)}catch(k){alert("Failed to update user role: "+(k instanceof Error?k.message:"Unknown error"))}},b=async f=>{if(window.confirm("Are you sure you want to deactivate this user?"))try{await d(f)}catch(y){alert("Failed to deactivate user: "+(y instanceof Error?y.message:"Unknown error"))}},x=async f=>{try{await u(f)}catch(y){alert("Failed to reactivate user: "+(y instanceof Error?y.message:"Unknown error"))}},p=async f=>{if(window.confirm("Are you sure you want to cancel this invitation?"))try{await h(f)}catch(y){alert("Failed to cancel invitation: "+(y instanceof Error?y.message:"Unknown error"))}},w=f=>{switch(f){case"master_admin":return"bg-purple-100 text-purple-800";case"admin":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsxs("p",{className:"text-gray-600",children:["Manage users in ",t.name]})]}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{children:"Invite User"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-500 p-3 rounded-lg",children:e.jsx(ae,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-500 p-3 rounded-lg",children:e.jsx(re,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(f=>f.is_active).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-500 p-3 rounded-lg",children:e.jsx(Ne,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Admins"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(f=>f.role==="admin"||f.role==="master_admin").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-yellow-500 p-3 rounded-lg",children:e.jsx(pt,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Invites"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Organization Members"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"User"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Last Login"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Joined"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(f=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:f.full_name||"No name set"}),e.jsx("p",{className:"text-sm text-gray-600",children:f.email})]})}),e.jsx("td",{className:"py-4 px-6",children:l&&f.role!=="master_admin"?e.jsxs("select",{value:f.role,onChange:y=>v(f.id,y.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]}):e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${w(f.role)}`,children:f.role.replace("_"," ")})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${f.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:f.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:f.last_login?D(new Date(f.last_login),"MMM dd, yyyy"):"Never"}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:D(new Date(f.created_at),"MMM dd, yyyy")}),e.jsx("td",{className:"py-4 px-6",children:f.id!==(n==null?void 0:n.id)&&f.role!=="master_admin"&&e.jsx("div",{className:"flex items-center space-x-2",children:f.is_active?e.jsx("button",{onClick:()=>b(f.id),className:"text-red-600 hover:text-red-700 text-sm",children:"Deactivate"}):e.jsx("button",{onClick:()=>x(f.id),className:"text-green-600 hover:text-green-700 text-sm",children:"Reactivate"})})})]},f.id))})]})})]}),r.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pending Invitations"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Invited By"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Sent"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Expires"}),e.jsx("th",{className:"text-left py-3 px-6 font-semibold text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{children:r.map(f=>{var y,k;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:f.email})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${w(f.role)}`,children:f.role})}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:((y=f.invited_by_profile)==null?void 0:y.full_name)||((k=f.invited_by_profile)==null?void 0:k.email)||"Unknown"}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:D(new Date(f.created_at),"MMM dd, yyyy")}),e.jsx("td",{className:"py-4 px-6 text-sm text-gray-600",children:D(new Date(f.expires_at),"MMM dd, yyyy")}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("button",{onClick:()=>p(f.id),className:"text-red-600 hover:text-red-700 text-sm",children:"Cancel"})})]},f.id)})})]})})]}),e.jsx(Ai,{isOpen:m,onClose:()=>g(!1)})]})},Ti=()=>{var y,k,A,O;const{token:n}=Ze(),t=me(),{acceptInvitation:s}=W(),[r,a]=j.useState(null),[i,o]=j.useState(!0),[l,c]=j.useState(!1),[d,u]=j.useState(null),[h,m]=j.useState(""),[g,v]=j.useState(""),[b,x]=j.useState(!1),[p,w]=j.useState(!1);j.useEffect(()=>{(async()=>{if(!n){u("Invalid invitation link"),o(!1);return}try{const{data:K,error:N}=await G.from("user_invitations").select(`
            *,
            organization:organizations(name),
            invited_by_profile:user_profiles!user_invitations_invited_by_fkey(full_name, email)
          `).eq("token",n).is("accepted_at",null).gt("expires_at",new Date().toISOString()).single();N?u("Invalid or expired invitation"):a(K)}catch{u("Failed to load invitation")}finally{o(!1)}})()},[n]);const f=async F=>{if(F.preventDefault(),h!==g){u("Passwords do not match");return}if(h.length<6){u("Password must be at least 6 characters long");return}c(!0),u(null);try{await s(n,h),t("/")}catch(K){u(K instanceof Error?K.message:"Failed to accept invitation")}finally{c(!1)}};return i?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading invitation..."})]})}):d&&!r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-6 mx-auto w-24 h-24 flex items-center justify-center mb-6",children:e.jsx(xs,{className:"h-12 w-12 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Invalid Invitation"}),e.jsx("p",{className:"text-gray-600 mb-6",children:d}),e.jsx("button",{onClick:()=>t("/"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Login"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-blue-100",children:e.jsx(Pt,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:["Join ",(y=r==null?void 0:r.organization)==null?void 0:y.name]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["You've been invited by ",((k=r==null?void 0:r.invited_by_profile)==null?void 0:k.full_name)||((A=r==null?void 0:r.invited_by_profile)==null?void 0:A.email)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Invitation Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:r==null?void 0:r.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Role:"}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${(r==null?void 0:r.role)==="admin"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:r==null?void 0:r.role})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Organization:"}),e.jsx("span",{className:"font-medium",children:(O=r==null?void 0:r.organization)==null?void 0:O.name})]})]})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[d&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:d}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Create Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"password",name:"password",type:b?"text":"password",required:!0,value:h,onChange:F=>m(F.target.value),className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password",disabled:l}),e.jsx("button",{type:"button",onClick:()=>x(!b),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:l,children:b?e.jsx(gt,{className:"h-5 w-5"}):e.jsx(_e,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"confirm-password",name:"confirm-password",type:p?"text":"password",required:!0,value:g,onChange:F=>v(F.target.value),className:"block w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm your password",disabled:l}),e.jsx("button",{type:"button",onClick:()=>w(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:l,children:p?e.jsx(gt,{className:"h-5 w-5"}):e.jsx(_e,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"What's next?"}),e.jsx("p",{className:"mt-1 text-sm text-blue-800",children:"After creating your account, you'll have access to your organization's documents and can collaborate with your team."})]})]})}),e.jsx("button",{type:"submit",disabled:l||!h||!g,className:"w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:l?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating account..."]}):"Accept Invitation & Create Account"})]})]})]})})},Di=()=>{const{provider:n}=Ze(),[t]=tr(),s=me(),{handleOAuthCallback:r}=zt(),[a,i]=j.useState("loading"),[o,l]=j.useState("");return j.useEffect(()=>{(async()=>{const d=t.get("code"),u=t.get("state"),h=t.get("error");if(h){i("error"),l(`OAuth error: ${h}`);return}if(!d||!u||!n){i("error"),l("Missing required OAuth parameters");return}try{await r(d,u,n)?(i("success"),l("Successfully connected to "+n),setTimeout(()=>s("/"),2e3)):(i("error"),l("Failed to complete OAuth connection"))}catch(m){i("error"),l(m instanceof Error?m.message:"OAuth callback failed")}})()},[t,n,r,s]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full text-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[a==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx(Cr,{className:"h-12 w-12 text-blue-600 mx-auto mb-4 animate-spin"}),e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:["Connecting to ",n,"..."]}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we complete the connection."})]}),a==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connection Successful!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you back to Adminezer..."})]}),a==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(xs,{className:"h-12 w-12 text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connection Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:o}),e.jsx("button",{onClick:()=>s("/"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Return to Dashboard"})]})]})})})},$i=()=>{const{connections:n,loading:t,isConnected:s,initiateOAuth:r,disconnectProvider:a}=zt(),[i,o]=j.useState(null),l=d=>{r(d)},c=async(d,u)=>{if(window.confirm(`Are you sure you want to disconnect ${u}?`)){o(d);try{await a(d)}catch(h){alert("Failed to disconnect: "+(h instanceof Error?h.message:"Unknown error"))}finally{o(null)}}};return t?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((d,u)=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},u))})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"OAuth Connections"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Securely connect to third-party services using OAuth authentication"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-4",children:Object.values(ve).map(d=>{const u=n.find(m=>m.provider_id===d.id&&m.is_active),h=s(d.id);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${h?"bg-green-100":"bg-gray-100"}`,children:h?e.jsx(re,{className:"h-5 w-5 text-green-600"}):e.jsx(Ar,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:d.name}),e.jsx("p",{className:"text-sm text-gray-600",children:d.description}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:d.category}),h&&u&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Connected ",D(new Date(u.created_at),"MMM dd, yyyy")]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:h&&u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"px-3 py-1 text-sm bg-green-100 text-green-800 rounded-full",children:"Connected"}),e.jsxs("button",{onClick:()=>c(u.id,d.name),disabled:i===u.id,className:"flex items-center space-x-1 px-3 py-1 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(Er,{className:"h-4 w-4"}),e.jsx("span",{children:i===u.id?"Disconnecting...":"Disconnect"})]})]}):e.jsxs("button",{onClick:()=>l(d.id),className:"flex items-center space-x-1 px-3 py-1 text-sm bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors",children:[e.jsx(vt,{className:"h-4 w-4"}),e.jsx("span",{children:"Connect"})]})})]}),h&&u&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Scopes:"}),e.jsx("div",{className:"mt-1",children:u.scopes.map((m,g)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded mr-1 mb-1",children:m.split("/").pop()||m},g))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Expires:"}),e.jsx("p",{className:"text-gray-900 mt-1",children:D(new Date(u.expires_at),"MMM dd, yyyy HH:mm")})]})]})})]},d.id)})}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ne,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"About OAuth Security"}),e.jsx("p",{className:"text-sm text-blue-800 mt-1",children:"OAuth connections allow secure access to third-party services without storing your passwords. Tokens are automatically refreshed and can be revoked at any time. Your credentials remain secure and are never stored in Adminezer."})]})]})})]})]})},Pi=()=>e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 text-center text-sm font-medium shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx("span",{children:"Portfolio Demo Mode"}),e.jsxs("div",{className:"group relative",children:[e.jsx(hs,{className:"h-4 w-4 cursor-help"}),e.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-black text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:"This is a demonstration version with sample data for portfolio purposes"})]})]})});function Ii(){const n=ti;return e.jsx(n,{children:e.jsxs(sr,{children:[e.jsx(Pi,{}),e.jsxs(qt,{children:[e.jsx(z,{path:"/invite/:token",element:e.jsx(Ti,{})}),e.jsx(z,{path:"/oauth/callback/:provider",element:e.jsx(Di,{})}),e.jsx(z,{path:"/*",element:e.jsx(ri,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 pt-10",children:[e.jsx(vi,{}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:e.jsxs(qt,{children:[e.jsx(z,{path:"/",element:e.jsx(mi,{})}),e.jsx(z,{path:"/documents",element:e.jsx(pi,{})}),e.jsx(z,{path:"/upload",element:e.jsx(xi,{})}),e.jsx(z,{path:"/operations",element:e.jsx(Si,{})}),e.jsx(z,{path:"/operations/:category",element:e.jsx(ki,{})}),e.jsx(z,{path:"/department/:department",element:e.jsx(Ci,{})}),e.jsx(z,{path:"/users",element:e.jsx(Oi,{})}),e.jsx(z,{path:"/oauth",element:e.jsx($i,{})})]})})]})})})]})]})})}wt.createRoot(document.getElementById("root")).render(e.jsx(Se.StrictMode,{children:e.jsx(Ii,{})}));
